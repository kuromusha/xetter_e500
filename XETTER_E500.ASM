1000 ";  XETTER E500
1001 ";     for PC-E500
1002 "; Sep. 9, 1990
1003 ";     by K.Kuromusha   No.17
1004 "
1005 "ORG 0BC000H,0B9800H
1006 "
1007 "CTRLC EQU 0BFC29H
1008 "DOTSP EQU 0BFC96H
1009 "LCDMD EQU 0BFCA1H
1010 "TMVEC EQU 0BFCC6H
1011 "FILE  EQU 0FFFE4H
1012 "IOCS  EQU 0FFFE8H
1013 "R0    EQU 000H
1014 "R1    EQU 001H
1015 "R2    EQU 002H
1016 "R3    EQU 003H
1017 "R4    EQU 004H
1018 "R5    EQU 005H
1019 "R6    EQU 006H
1020 "R7    EQU 007H
1021 "R8    EQU 008H
1022 "R9    EQU 009H
1023 "R10   EQU 00AH
1024 "RE0   EQU 010H
1025 "RE1   EQU 011H
1026 "RE2   EQU 012H
1027 "RE3   EQU 013H
1028 "RE4   EQU 014H
1029 "RE5   EQU 015H
1030 "RE6   EQU 016H
1031 "RE7   EQU 017H
1032 "RE8   EQU 018H
1033 "RE9   EQU 019H
1034 "RE10  EQU 01AH
1035 "Q0    EQU 020H
1036 "Q1    EQU 021H
1037 "Q2    EQU 022H
1038 "Q3    EQU 023H
1039 "Q4    EQU 024H
1040 "Q5    EQU 025H
1041 "Q6    EQU 026H
1042 "G0    EQU 030H
1043 "G1    EQU 031H
1044 "G2    EQU 032H
1045 "G3    EQU 033H
1046 "G4    EQU 034H
1047 "G5    EQU 035H
1048 "G6    EQU 036H
1049 "G7    EQU 037H
1050 "G8    EQU 038H
1051 "GR0   EQU 040H
1052 "GR1   EQU 041H
1053 "GR3   EQU 043H
1054 "GR4   EQU 044H
1055 "GR5   EQU 045H
1056 "GR6   EQU 046H
1057 "GR7   EQU 047H
1058 "GR8   EQU 048H
1059 "BX    EQU 0D4H
1060 "BL    EQU 0D4H
1061 "BH    EQU 0D5H
1062 "CX    EQU 0D6H
1063 "CL    EQU 0D6H
1064 "DX    EQU 0D8H
1065 "SI    EQU 0DAH
1066 "BP    EQU 0ECH
1067 "KO    EQU 0F0H
1068 "KO1   EQU 0F1H
1069 "KI    EQU 0F2H
1070 "IMR   EQU 0FBH
1071 "
1072 "CALL SHOKI
1073 "L0: CALL DEMO
1074 "L1: MV A,[MEN]
1075 "CMP A,31
1076 "JRNZ L2
1077 "MV A,1
1078 "MV [MEN],A
1079 "L2: CALL S3
1080 "LOOP: CALL IMOVE
1081 "CALL SSC
1082 "MV A,[BOM]
1083 "DEC A
1084 "JPZ BOMY
1085 "MVW (R0),[CLR]
1086 "OR (R0),(R1)
1087 "JPZ CLR1
1088 "CALL MENSC
1089 "CALL EMOVE
1090 "CALL SSC
1091 "CALL MENSC
1092 "MV A,[BOM]
1093 "DEC A
1094 "JPZ BOMY0
1095 "CALL YMOVE
1096 "CALL MENSC
1097 "MV I,[TIME]
1098 "DEC I
1099 "MV [TIME],I
1100 "CALL SSC
1101 "MV A,[BOM]
1102 "DEC A
1103 "JPZ BOMY
1104 "MVW (R0),[TIME]
1105 "OR (R0),(R1)
1106 "JPZ BOMY
1107 "JR LOOP
1108 "
1109 "SHOKI: PUSHU IMR
1110 "MV X,S
1111 "INC X
1112 "INC X
1113 "PUSHU X
1114 "MV X,[TMVEC]
1115 "PUSHU X
1116 "MV X,TIMER
1117 "MV [TMVEC],X
1118 "PRE 30H MV [--U],(BP)
1119 "PRE 30H MV (BP),0
1120 "MV I,440
1121 "MV X,GAMN
1122 "MV BA,505H
1123 "SHOKI0: MV [X++],BA
1124 "DEC I
1125 "JRNZ SHOKI0
1126 "MV A,0
1127 "MV [LCDMD],A
1128 "MV I,428H
1129 "MV [0BFC9DH],I ;lcd width
1130 "MV I,0FFFFH
1131 "MV [0BFC2AH],I ;linptn
1132 "MVW (CX),0
1133 "MVW (BX),0
1134 "MV I,48H
1135 "MV A,[(0E6H)+8]
1136 "CALL CIOCS
1137 "RET
1138 "
1139 "BASIC: MV (IMR),0
1140 "MV (BP),[U++]
1141 "POPU X
1142 "MV [TMVEC],X
1143 "POPU X
1144 "MV S,X
1145 "POPU IMR
1146 "RC
1147 "RETF
1148 "
1149 "MENSA: CALL MENPT
1150 "CALL MENTR
1151 "RET
1152 "
1153 "MENSB: MV A,0
1154 "MV [TCONT],A
1155 "CALLF TIMER
1156 "RET
1157 "
1158 "MENSC: MV A,[PJ]
1159 "SUB A,40H
1160 "MV [PJ],A
1161 "CMP A,80H
1162 "JRC MENSB
1163 "JR MENSA
1164 "
1165 "TIMER: MV A,[TCONT]
1166 "SUB A,1
1167 "JRC TIMER1
1168 "MV [TCONT],A
1169 "RETF
1170 "TIMER1: MV A,[MENST]
1171 "XOR A,1
1172 "MV [MENST],A
1173 "MV A,[MENSS]
1174 "SUB A,40H
1175 "MV [MENSS],A
1176 "CALL MENPT
1177 "CALL MENTR
1178 "MV A,16
1179 "MV [TCONT],A
1180 "RETF
1181 "
1182 "CIOCS: MV (BP),[U]
1183 "CALLF IOCS
1184 "PRE 30H MV (BP),0
1185 "RET
1186 "
1187 "CFILE: MV (BP),[U]
1188 "CALLF FILE
1189 "PRE 30H MV (BP),0
1190 "RET
1191 "
1192 "WAIT0: PUSHU I
1193 "MV I,5000
1194 "WAIT
1195 "POPU I
1196 "RET
1197 "
1198 "HI:   DS 3
1199 "DEM0: DM 'X E T T E R '
1200 "DEM1: DM 'E500 '
1201 "DEM2: DM '  G  A  M  E  '
1202 "DEM3: DM 'Programmed by'
1203 "DEM4: DM 'START'
1204 "DEM6: DM ' EXIT'
1205 "DB 0FFH
1206 "DM 'SELECT'
1207 "DB 0FFH
1208 "DM 'CONST.'
1209 "DB 0FFH
1210 "DEM5: DM 'K.Kuromusha'
1211 "DEM7: DM 'Please select Scene.'
1212 "
1213 "DEMO: MV X,0
1214 "MV [SC],X
1215 "MV A,1
1216 "MV [MEN],A
1217 "DEC A
1218 "MV [CONST],A
1219 "MV A,5
1220 "MV [MY],A
1221 "MVW (CX),0
1222 "MV I,51H
1223 "CALL CIOCS
1224 "MV I,42H
1225 "MVW (BX),20EH
1226 "MV X,DEM0
1227 "MV Y,11
1228 "CALL CIOCS
1229 "MV X,135000
1230 "DEMO0: DEC X
1231 "JRNZ DEMO0
1232 "MV I,51H
1233 "CALL CIOCS
1234 "MV I,42H
1235 "MV (BH),1
1236 "MV (R0),14
1237 "DEMO1: MV (BL),(R0)
1238 "MV X,DEM0
1239 "MV Y,12
1240 "CALL CIOCS
1241 "CALL WAIT0
1242 "DEC (R0)
1243 "CMP (R0),5
1244 "JRNZ DEMO1
1245 "ADD (R0),3
1246 "MVP (R1),DEM0+1
1247 "MVP (R4),10
1248 "MV (R7),5
1249 "DEMO2: MV (R8),2
1250 "DEMO3: MV (BL),(R0)
1251 "MV X,(R1)
1252 "MV Y,(R4)
1253 "CALL CIOCS
1254 "CALL WAIT0
1255 "INC (R0)
1256 "DEC (R8)
1257 "JRNZ DEMO3
1258 "ADD (R0),2
1259 "MV X,(R1)
1260 "INC X
1261 "INC X
1262 "MV (R1),X
1263 "DEC (R4)
1264 "DEC (R4)
1265 "DEC (R7)
1266 "JRNZ DEMO2
1267 "CALL TITLE
1268 "MV I,42H
1269 "MV (R0),39
1270 "DEMO4: MV (BL),(R0)
1271 "MV X,DEM1
1272 "MV Y,5
1273 "CALL CIOCS
1274 "CALL WAIT0
1275 "DEC (R0)
1276 "CMP (R0),29
1277 "JRNZ DEMO4
1278 "MVW (BX),201H
1279 "MV X,DEM2
1280 "MV Y,14
1281 "CALL CIOCS
1282 "MV (BL),25
1283 "MV X,DEM3
1284 "MV Y,13
1285 "CALL CIOCS
1286 "MV I,58H
1287 "MVW (BX),300H
1288 "MV BA,3
1289 "MV X,DEM4
1290 "CALL CIOCS
1291 "MV I,42H
1292 "MV (BL),28
1293 "MV X,DEM5
1294 "MV Y,11
1295 "CALL CIOCS
1296 "MV I,DEMO
1297 "MV [SELRT],I
1298 "MV X,DEM4
1299 "MV [SELSX],X
1300 "DEMO5: CALL KEYIN
1301 "DEC (R0)
1302 "JRNZ DEMO6 
1303 "RET
1304 "DEMO6: DEC (R0)
1305 "JPZ SELCT
1306 "DEC (R0)
1307 "JRNZ DEMO5
1308 "JP EDIT
1309 "
1310 "KEYIN: MV X,0
1311 "KEYIN0: MV (KO),0
1312 "MV (KO1),4
1313 "MV (R0),0
1314 "MV (R1),80H
1315 "MV (R2),(KI)
1316 "KEYIN1: INC (R0)
1317 "CMP (R0),6
1318 "JRZ KEYIN4
1319 "ROR (R1)
1320 "MV (R3),(R2)
1321 "AND (R3),(R1)
1322 "JRZ KEYIN1
1323 "KEYIN3: MV (R4),[KDATA]
1324 "CMP (R4),(R0)
1325 "JRZ KEYIN0
1326 "MV [KDATA],(R0)
1327 "RET
1328 "KEYIN4: MV (KO1),0
1329 "MV (KO),4
1330 "MV (R1),40H
1331 "AND (R1),(KI)
1332 "JRNZ KEYIN3
1333 "INC (R0)
1334 "MV (KO),20H
1335 "MV (R1),20H
1336 "AND (R1),(KI)
1337 "JRNZ KEYIN3
1338 "MV (KO),40H
1339 "MV (R1),80H
1340 "MV (R2),(KI)
1341 "KEYIN5: INC (R0)
1342 "CMP (R0),11
1343 "JRZ KEYIN6
1344 "ROR (R1)
1345 "MV (R3),(R2)
1346 "AND (R3),(R1)
1347 "JRZ KEYIN5
1348 "JR KEYIN3
1349 "KEYIN6: MV (KO),80H
1350 "MV (R1),20H
1351 "MV (R2),(KI)
1352 "AND (R1),(R2)
1353 "JRNZ KEYIN3
1354 "AND (R2),1
1355 "INC (R0)
1356 "MV (KO),8
1357 "MV (R1),80H
1358 "AND (R1),(KI)
1359 "JRNZ KEYIN3
1360 "INC (R0)
1361 "MV (KO),10H
1362 "MV (R1),40H
1363 "AND (R1),(KI)
1364 "JRNZ KEYIN3
1365 "MV (KO),1
1366 "INC (R0)
1367 "MV (R1),(KI)
1368 "MV (R3),(R1)
1369 "AND (R3),40H
1370 "OR (R3),(R2)
1371 "CMP (R3),41H
1372 "JRZ KEYIN3
1373 "MV (R0),10H
1374 "AND (R0),(R1)
1375 "JPNZ BASIC
1376 "MV [KDATA],(R0)
1377 "DEC X
1378 "JRNZ KEYIN0
1379 "MVW (CX),8
1380 "MV I,41H
1381 "CALL CIOCS
1382 "JR KEYIN
1383 "
1384 "TITLEX: 
1385 "DW 07007H,07007H,07C07H,01C0EH
1386 "DW 01F0EH,0001EH,007FCH,01FFCH
1387 "DW 01FF0H,03C00H,0387CH,0381CH
1388 "DW 0701FH,07007H,07007H
1389 "TITLEE: 
1390 "DW 07FFFH,07FFFH,07FFFH,07FFFH
1391 "DW 07000H,071C7H,071C7H,071C7H
1392 "DW 071C7H,071C7H,071C7H,071C7H
1393 "DW 07007H,07007H,07007H
1394 "TITLET: 
1395 "DW 00007H,00007H,00007H,00007H
1396 "DW 00007H,00007H,07FF7H,07FF7H
1397 "DW 07FF7H,00007H,00007H,00007H
1398 "DW 00007H,00007H,00007H
1399 "TITLER: 
1400 "DW 07FFFH,07FFFH,07FFFH,07FFFH
1401 "DW 00007H,001C7H,00FC7H,01FC7H
1402 "DW 03FC7H,039C7H,070EEH,070FEH
1403 "DW 070FEH,0707CH,07038H
1404 "
1405 "TITLE: MVW (CX),0
1406 "MV (R0),0
1407 "MV [DOTSP],(R0)
1408 "MVP (R0),TITLEX
1409 "MV X,36
1410 "CALL TISUB
1411 "MVP (R0),TITLEE
1412 "MV X,60
1413 "CALL TISUB
1414 "MVP (R0),TITLET
1415 "MV X,84
1416 "CALL TISUB
1417 "MVP (R0),TITLET
1418 "MV X,108
1419 "CALL TISUB
1420 "MVP (R0),TITLEE
1421 "MV X,132
1422 "CALL TISUB
1423 "MVP (R0),TITLER
1424 "MV X,156
1425 "CALL TISUB
1426 "RET
1427 "
1428 "TISUB: MV (R3),15
1429 "TISUB0: MV A,[(R0)]
1430 "MV Y,0
1431 "MV (R4),X
1432 "MV I,4AH
1433 "CALL CIOCS
1434 "MV Y,(R0)
1435 "INC Y
1436 "MV (R0),Y
1437 "MV A,[(R0)]
1438 "MV Y,8
1439 "MV X,(R4)
1440 "MV I,4AH
1441 "CALL CIOCS
1442 "MV Y,(R0)
1443 "INC Y
1444 "MV (R0),Y
1445 "DEC (R3)
1446 "JRNZ TISUB0
1447 "RET
1448 "
1449 "SELCT: MV I,51H
1450 "CALL CIOCS
1451 "MVW (R8),'1 '
1452 "MVP (R0),DATA+95
1453 "MVP (R3),96
1454 "MV (R6),3
1455 "MV (BH),0
1456 "SELCT0: MV (R7),10
1457 "MV (BL),0
1458 "SELCT1: MV X,SELD0
1459 "MVW [SELD0],(R8)
1460 "MV Y,2
1461 "MV I,42H
1462 "CALL CIOCS
1463 "MV (R10),[(R0)]
1464 "MV A,'*'
1465 "OR (R10),0
1466 "JRZ SELCT2
1467 "MV A,' '
1468 "SELCT2: MV I,41H
1469 "CALL CIOCS
1470 "INC (BL)
1471 "MV I,3
1472 "ADCL (R0),(R3)
1473 "INC (R9)
1474 "CMP (R9),':'
1475 "JRNZ SELCT3
1476 "MV (R9),'0'
1477 "INC (R8)
1478 "CMP (R8),'!'
1479 "JRNZ SELCT3
1480 "MV (R8),'1'
1481 "SELCT3: DEC (R7)
1482 "JRNZ SELCT1
1483 "INC (BH)
1484 "DEC (R6)
1485 "JRNZ SELCT0
1486 "MV (BL),0
1487 "MV I,58H
1488 "MV BA,1
1489 "MV X,[SELSX]
1490 "CALL CIOCS
1491 "MV (BL),32
1492 "MV I,58H
1493 "MV BA,8001H
1494 "MV X,DEM6
1495 "CALL CIOCS
1496 "MV I,42H
1497 "MV (BL),10
1498 "MV X,DEM7
1499 "MV Y,20
1500 "CALL CIOCS
1501 "MVW (RE6),0
1502 "MV A,2
1503 "MV [DOTSP],A
1504 "MVW (RE4),0
1505 "MVW (RE1),0
1506 "SELCT7: MV (RE3),(RE7)
1507 "ROL (RE3)
1508 "ROL (RE3)
1509 "ROL (RE3)
1510 "MV (RE0),(RE6)
1511 "ROL (RE0)
1512 "ROL (RE0)
1513 "ROL (RE0)
1514 "MV A,(RE0)
1515 "ROL (RE0)
1516 "ADD (RE0),A
1517 "MV X,(RE0)
1518 "MV Y,(RE3)
1519 "MVW (BX),(RE0)
1520 "MVW (DX),(RE3)
1521 "ADD (BX),17
1522 "ADD (DX),7
1523 "MVW (CX),0
1524 "MV I,4FH
1525 "CALL CIOCS
1526 "SELCT6: CALL KEYIN
1527 "CMP (R0),1
1528 "JRNZ SELCT4
1529 "MV (RE8),(RE7)
1530 "ROL (RE7)
1531 "MV A,(RE7)
1532 "ROL (RE7)
1533 "ROL (RE7)
1534 "ADD A,(RE7)
1535 "ADD A,(RE6)
1536 "INC A
1537 "MV [MEN],A
1538 "MV (RE7),(RE8)
1539 "MV (R0),[CONST]
1540 "OR (R0),0
1541 "JRZ SELCTH
1542 "MVP (R0),DATA-1
1543 "SELCTI: ADD (R0),96
1544 "ADC (R1),0
1545 "DEC A
1546 "JRNZ SELCTI
1547 "MV A,[(R0)]
1548 "OR A,0
1549 "JRNZ SELCT6
1550 "SELCTH: RET
1551 "SELCT4: CMP (R0),5
1552 "JRNZ SELCT5
1553 "MV I,[SELRT]
1554 "MV [--S],I
1555 "RET
1556 "SELCT5: CMP (R0),7
1557 "JRNZ SELCT8
1558 "DEC (RE6)
1559 "CMP (RE6),0FFH
1560 "JRNZ SELSUB
1561 "MV (RE6),9
1562 "JR SELSUB
1563 "SELCT8: CMP (R0),11
1564 "JRNZ SELCT9
1565 "INC (RE6)
1566 "CMP (RE6),10
1567 "JRNZ SELSUB
1568 "MV (RE6),0
1569 "JR SELSUB
1570 "SELCT9: CMP (R0),8
1571 "JRNZ SELCTA
1572 "SELCTD: INC (RE7)
1573 "CMP (RE7),3
1574 "JRNZ SELSUB
1575 "MV (RE7),0
1576 "JR SELSUB
1577 "SELCTA: CMP (R0),10
1578 "JRNZ SELCTB
1579 "SELCTF: DEC (RE7)
1580 "CMP (RE7),0FFH
1581 "JRNZ SELSUB
1582 "MV (RE7),2
1583 "JR SELSUB
1584 "SELCTB: CMP (R0),4
1585 "JRNZ SELCTC
1586 "INC (RE6)
1587 "CMP (RE6),10
1588 "JRNZ SELSUB
1589 "MV (RE6),0
1590 "JR SELCTD
1591 "SELCTC: CMP (R0),3
1592 "JRNZ SELCTE
1593 "DEC (RE6)
1594 "CMP (RE6),0FFH
1595 "JRNZ SELSUB
1596 "MV (RE6),9
1597 "JR SELCTF
1598 "SELCTE: CMP (R0),2
1599 "JRNZ SELCT6
1600 "MVW (RE6),0
1601 "MVP (R1),DATA+95
1602 "MVP (R4),96
1603 "SELCTG: MV A,[(R1)]
1604 "MV I,3
1605 "ADCL (R1),(R4)
1606 "OR A,0
1607 "JRNZ SELSUB
1608 "INC (RE6)
1609 "CMP (RE6),10
1610 "JRNZ SELCTG
1611 "MV (RE6),0
1612 "INC (RE7)
1613 "CMP (RE7),3
1614 "JRNZ SELCTG
1615 "MV (RE7),0
1616 "SELSUB: MVW (CX),0
1617 "MV I,4FH
1618 "MV X,(RE0)
1619 "MV Y,(RE3)
1620 "CALL CIOCS
1621 "JP SELCT7
1622 "
1623 "ED0: DM ' CONSTRUCTION MODE'
1624 "ED1: DM ' EDIT'
1625 "DB 0FFH
1626 "ED2: DM ' LOAD'
1627 "DB 0FFH
1628 "ED3: DM ' SAVE'
1629 "DB 0FFH
1630 "ED4: DM 'VERIFY'
1631 "DB 0FFH
1632 "ED5: DM ' EXIT'
1633 "DB 0FFH
1634 "ED6: DM 'FILES'
1635 "DB 0FFH
1636 "DM 'CHANGE'
1637 "DB 0FFH
1638 "DM 'No.'
1639 "DB 0FFH
1640 "ED7: DM 'DEVICE'
1641 "ED8: DM '** SAVE '
1642 "ED9: DM '** LOAD '
1643 "EDA: DM '** VERIFY **'
1644 "EDB: DM 'Now working !'
1645 "EDC: DM '** FILES ** '
1646 "
1647 "EDIT: MV A,1
1648 "MV [CONST],A
1649 "MVW (CX),0
1650 "MV I,51H
1651 "CALL CIOCS
1652 "MV I,42H
1653 "MVW (BX),10AH
1654 "MV X,ED0
1655 "MV Y,19
1656 "MV A,40H
1657 "MV [LCDMD],A
1658 "CALL CIOCS
1659 "MV A,0
1660 "MV [LCDMD],A
1661 "MV I,58H
1662 "MVW (BX),300H
1663 "MV BA,5
1664 "MV X,ED1
1665 "CALL CIOCS
1666 "EDIT0: CALL KEYIN
1667 "DEC (R0)
1668 "JPZ EDITR
1669 "DEC (R0)
1670 "JPZ LOAD
1671 "DEC (R0)
1672 "JRZ SAVE
1673 "DEC (R0)
1674 "JPZ VRFY
1675 "DEC (R0)
1676 "JPZ DEMO
1677 "JR EDIT0
1678 "
1679 "DEVSV: DB 0
1680 "DEVNO: DB '0'
1681 "DV0: DM '  E:'
1682 "DV1: DM '  F:'
1683 "DV2: DM '  X:'
1684 "DV3: DM 'CAS:'
1685 "
1686 "SAVE: MV I,51H
1687 "CALL CIOCS
1688 "MV I,42H
1689 "MVW (BX),15
1690 "MV X,ED8
1691 "MV Y,10
1692 "CALL CIOCS
1693 "MVW (BX),300H
1694 "MV I,58H
1695 "MV BA,1
1696 "MV X,ED3
1697 "CALL CIOCS
1698 "MV I,SAVE5
1699 "MV [SELRT],I
1700 "MV I,SAVE
1701 "MV [SELSX],I
1702 "SVSEL: MV I,58H
1703 "MV (BL),8
1704 "MV BA,8003H
1705 "MV X,ED6
1706 "CALL CIOCS
1707 "MV I,58H
1708 "MV BA,8001H
1709 "MV X,ED5
1710 "CALL CIOCS
1711 "MVW (BX),20EH
1712 "MV I,42H
1713 "MV X,ED7
1714 "MV Y,6
1715 "CALL CIOCS
1716 "MV (RE3),[DEVSV]
1717 "MV (RE4),[DEVNO]
1718 "SAVE0: MV I,42H
1719 "MVP (RE0),DV0
1720 "MV A,(RE3)
1721 "ROL A
1722 "ROL A
1723 "ADD (RE0),A
1724 "ADC (RE1),0
1725 "MVP [SAVEX],(RE0)
1726 "MV X,[SAVEX]
1727 "MV Y,4
1728 "MVW (BX),216H
1729 "CALL CIOCS
1730 "MV I,41H
1731 "MVW (BX),31EH
1732 "MV A,(RE4)
1733 "CALL CIOCS
1734 "SAVE1: CALL KEYIN
1735 "CMP (R0),5
1736 "JRNZ SAVE2
1737 "JP EDIT
1738 "SAVE2: CMP (R0),3
1739 "JRNZ SAVE3
1740 "INC (RE3)
1741 "CMP (RE3),4
1742 "JRNZ SAVE4
1743 "MV (RE3),0
1744 "SAVE4: MV [DEVSV],(RE3)
1745 "MVP (RE0),DV0+2
1746 "MV A,(RE3)
1747 "ROL A
1748 "ROL A
1749 "ADD (RE0),A
1750 "ADC (RE1),0
1751 "MV A,[(RE0)]
1752 "MV [SAVED],A
1753 "JR SAVE0
1754 "SAVE3: DEC (R0)
1755 "JRNZ SVNO
1756 "MV I,49H
1757 "MVW (BX),300H
1758 "CALL CIOCS
1759 "MV I,42H
1760 "MV X,EDB
1761 "MV Y,13
1762 "CALL CIOCS
1763 "MV I,[SELRT]
1764 "MV [--S],I
1765 "MV [SAVED+9],(RE4)
1766 "MV X,SAVED
1767 "CMP (RE3),3
1768 "RET
1769 "SVNO: DEC (R0)
1770 "JRZ FILES
1771 "CMP (R0),2
1772 "JRNZ SAVE1
1773 "INC (RE4)
1774 "CMP (RE4),':'
1775 "JRNZ SVNO0
1776 "MV (RE4),'0'
1777 "SVNO0: MV [DEVNO],(RE4)
1778 "JR SAVE0
1779 "
1780 "FILD0: DM ' bytes'
1781 "FILD1: DM ' free.'
1782 "FILD2: DM 'There exist'
1783 "FILD3: DM ' no Files.'
1784 "FILD4: DM ' File No.'
1785 "
1786 "FILES: CMP (RE3),3
1787 "JRZ SAVE1
1788 "MVW (BX),14
1789 "MV I,42H
1790 "MV X,EDC
1791 "MV Y,12
1792 "CALL CIOCS
1793 "MV I,49H
1794 "MV (BH),3
1795 "CALL CIOCS
1796 "MV I,0FH
1797 "MV A,0
1798 "MV X,SAVED
1799 "CALL CFILE
1800 "JPC ERROR
1801 "MVP (R0),(SI)
1802 "MV X,(R0)
1803 "CALL DAA
1804 "MVW (CX),0
1805 "MVW (BX),300H
1806 "MV I,42H
1807 "MV X,DAADT
1808 "MV Y,7
1809 "CALL CIOCS
1810 "MV Y,6
1811 "MV X,(R0)
1812 "MV IL,2
1813 "SUB X,IL
1814 "JRNC FILES1
1815 "DEC Y
1816 "FILES1: MV X,FILD0
1817 "MV I,42H
1818 "CALL CIOCS
1819 "MV X,FILD1
1820 "MV Y,6
1821 "CALL CIOCS
1822 "MVW (BX),100H
1823 "MV X,FILD2
1824 "MV Y,11
1825 "CALL CIOCS
1826 "MV (R0),'0'
1827 "MVW (R1),(BX)
1828 "MV (R3),0
1829 "MVP (R5),FILED
1830 "FILES2: MV [SAVED+9],(R0)
1831 "MV I,0CH
1832 "MV A,0
1833 "MVW (BX),0
1834 "MV X,SAVED
1835 "MV Y,LDHED
1836 "CALL CFILE
1837 "JRC FILES3
1838 "INC (R3)
1839 "MV (R4),(R0)
1840 "MV [(R5)],(R0)
1841 "ADD (R5),1
1842 "ADC (R6),0
1843 "FILES3: INC (R0)
1844 "CMP (R0),':'
1845 "JRNZ FILES2
1846 "MVW (CX),0
1847 "MVW (BX),(R1)
1848 "CMP (R3),2
1849 "JRNC FILES6
1850 "DEC (R3)
1851 "JRNZ FILES5
1852 "MV I,41H
1853 "MV A,'s'
1854 "CALL CIOCS
1855 "MV X,FILD4
1856 "MV Y,9
1857 "MV I,42H
1858 "CALL CIOCS
1859 "MV I,41H
1860 "MV A,(R4)
1861 "CALL CIOCS
1862 "MV A,'.'
1863 "CALL CIOCS
1864 "JR FILES4
1865 "FILES5: MV I,42H
1866 "MV X,FILD3
1867 "MV Y,10
1868 "CALL CIOCS
1869 "JR FILES4
1870 "FILES6: MV X,FILD4
1871 "MV Y,9
1872 "MV I,42H
1873 "CALL CIOCS
1874 "MV X,FILED
1875 "MVW (R4),0
1876 "MV Y,(R3)
1877 "CALL CIOCS
1878 "MV I,41H
1879 "MV A,'.'
1880 "CALL CIOCS
1881 "FILES4: MVW (CX),0
1882 "MV I,58H
1883 "MVW (BX),320H
1884 "MV BA,8001H
1885 "MV X,ED5
1886 "CALL CIOCS
1887 "FILES0: CALL KEYIN
1888 "CMP (R0),5
1889 "JRNZ FILES0
1890 "MV I,[SELSX]
1891 "MV [--S],I
1892 "RET
1893 "
1894 "LOAD: MV I,51H
1895 "CALL CIOCS
1896 "MV I,42H
1897 "MVW (BX),15
1898 "MV X,ED9
1899 "MV Y,10
1900 "CALL CIOCS
1901 "MVW (BX),300H
1902 "MV I,58H
1903 "MV BA,1
1904 "MV X,ED2
1905 "CALL CIOCS
1906 "MV I,LOAD0
1907 "MV [SELRT],I
1908 "MV I,LOAD
1909 "MV [SELSX],I
1910 "JP SVSEL
1911 "
1912 "VRFY: MV I,51H
1913 "CALL CIOCS
1914 "MV I,42H
1915 "MVW (BX),14
1916 "MV X,EDA
1917 "MV Y,12
1918 "CALL CIOCS
1919 "MVW (BX),300H
1920 "MV I,58H
1921 "MV BA,1
1922 "MV X,ED4
1923 "CALL CIOCS
1924 "MV I,VRFY0
1925 "MV [SELRT],I
1926 "MV I,VRFY
1927 "MV [SELSX],I
1928 "JP SVSEL
1929 "
1930 "ERR0: DM 'Error !!'
1931 "ERR1: DM 'Ok !!'
1932 "SAVED: DM 'E:XETTER  .DAT'
1933 "DB 0
1934 "SVHED: DB 1
1935 "DM 'XETTER       DAT'
1936 "DB 0DH
1937 "DW 2880,DATA,0,0,0,0,0BH
1938 "DS 16
1939 "
1940 "ERRORC: MV I,2
1941 "MV (CL),(R0)
1942 "CALL CFILE
1943 "ERROR: MVW (CX),0
1944 "MV I,49H
1945 "MVW (BX),300H
1946 "CALL CIOCS
1947 "MV X,ERR0
1948 "MV Y,8
1949 "ERROR0: MV I,42H
1950 "CALL CIOCS
1951 "MV I,58H
1952 "MV (BL),32
1953 "MV BA,8001H
1954 "MV X,ED5
1955 "CALL CIOCS
1956 "ERROR1: CALL KEYIN
1957 "CMP (R0),5
1958 "JPZ EDIT
1959 "JR ERROR1
1960 "
1961 "OK: MV I,2
1962 "MV (CL),(R0)
1963 "CALL CFILE
1964 "JRC ERROR
1965 "OK0: MVW (CX),0
1966 "MV I,49H
1967 "MVW (BX),300H
1968 "CALL CIOCS
1969 "MV X,ERR1
1970 "MV Y,5
1971 "JR ERROR0
1972 "
1973 "SAVE5: JRZ CSAVE
1974 "MV I,0
1975 "MV A,0
1976 "CALL CFILE
1977 "JRC ERROR
1978 "MV (R0),(CL)
1979 "MV I,4
1980 "MV X,DATA
1981 "MV Y,2880
1982 "CALL CFILE
1983 "JRNC OK
1984 "MV I,2
1985 "MV (CL),(R0)
1986 "CALL CFILE
1987 "JRC ERROR
1988 "MV I,0EH
1989 "MV X,SAVED
1990 "CALL CFILE
1991 "JR ERROR
1992 "
1993 "CSAVE: MVW (CX),4
1994 "MV I,44H
1995 "MV X,SVHED
1996 "CALL CIOCS
1997 "JRC ERROR
1998 "MV I,41H
1999 "MV X,DATA
2000 "MV Y,2880
2001 "CALL CIOCS
2002 "JRC ERROR
2003 "JR OK0
2004 "
2005 "LOAD0: JRZ CLOAD
2006 "MV I,1
2007 "MV A,1
2008 "CALL CFILE
2009 "JRC ERROR
2010 "MV (R0),(CL)
2011 "MV I,3
2012 "MV X,DATA
2013 "MV Y,2880
2014 "MV A,1
2015 "CALL CFILE
2016 "JPC ERRORC
2017 "JR OK
2018 "
2019 "LDDT0: DM 'Now Loading Data.'
2020 "LDDT1: DM 'Now Verifying Data.'
2021 "LDDT2: DM 'Skip '
2022 "
2023 "REAL: MV I,14H
2024 "MV X,SVHED
2025 "MV Y,LDHED
2026 "REAL0: MV (RE0),[X++]
2027 "MV (RE1),[Y++]
2028 "CMP (RE0),(RE1)
2029 "JRNZ REAL1
2030 "DEC I
2031 "JRNZ REAL0
2032 "RET
2033 "REAL1: MV I,42H
2034 "MV X,LDDT2
2035 "MV Y,5
2036 "CALL CIOCS
2037 "MV X,LDHED+1
2038 "MV Y,8
2039 "MV (RE0),[CTRLC]
2040 "MV A,40H
2041 "MV [CTRLC],A
2042 "CALL CIOCS
2043 "MV I,41H
2044 "MV A,'.'
2045 "CALL CIOCS
2046 "MV I,42H
2047 "MV X,LDHED+14
2048 "MV Y,3
2049 "CALL CIOCS
2050 "MV [CTRLC],(RE0)
2051 "OR A,1
2052 "RET
2053 "
2054 "CLOAD: MVW (CX),4
2055 "MV I,45H
2056 "MV X,LDHED
2057 "CALL CIOCS
2058 "JPC ERROR
2059 "MVW (CX),0
2060 "MV I,49H
2061 "MVW (BX),300H
2062 "CALL CIOCS
2063 "CALL REAL
2064 "JRNZ CLOAD
2065 "MV I,42H
2066 "MV X,LDDT0
2067 "MV Y,17
2068 "CALL CIOCS
2069 "MVW (CX),4
2070 "MV I,42H
2071 "MV X,DATA
2072 "MV Y,2880
2073 "CALL CIOCS
2074 "JPC ERROR
2075 "JP OK0
2076 "
2077 "VRFY0: JRZ CVRFY
2078 "MV I,1
2079 "MV A,1
2080 "CALL CFILE
2081 "JPC ERROR
2082 "MV (R0),(CL)
2083 "MV I,7
2084 "MV X,DATA
2085 "MV Y,2880
2086 "MV A,1
2087 "CALL CFILE
2088 "JPC ERRORC
2089 "JP OK
2090 "
2091 "CVRFY: MVW (CX),4
2092 "MV I,45H
2093 "MV X,LDHED
2094 "CALL CIOCS
2095 "JPC ERROR
2096 "MVW (CX),0
2097 "MV I,49H
2098 "MVW (BX),300H
2099 "CALL CIOCS
2100 "CALL REAL
2101 "JRNZ CVRFY
2102 "MV I,42H
2103 "MV X,LDDT1
2104 "MV Y,19
2105 "CALL CIOCS
2106 "MVW (CX),4
2107 "MV I,43H
2108 "MV X,DATA
2109 "MV Y,2880
2110 "CALL CIOCS
2111 "JPC ERROR
2112 "JP OK0
2113 "
2114 "DAA: PUSHU I
2115 "MV (Q0),X
2116 "MV X,DAADT
2117 "MVP (Q3),1000000
2118 "MV (Q6),'1'
2119 "MV I,3
2120 "SBCL (Q0),(Q3)
2121 "JRNC DAA0
2122 "MV I,3
2123 "ADCL (Q0),(Q3)
2124 "DEC (Q6)
2125 "DAA0: MV [X++],(Q6)
2126 "MVP (Q3),100000
2127 "MV (Q6),'/'
2128 "DAA1: INC (Q6)
2129 "MV I,3
2130 "SBCL (Q0),(Q3)
2131 "JRNC DAA1
2132 "MV I,3
2133 "ADCL (Q0),(Q3)
2134 "MV [X++],(Q6)
2135 "MVP (Q3),10000
2136 "MV (Q6),'/'
2137 "DAA2: INC (Q6)
2138 "MV I,3
2139 "SBCL (Q0),(Q3)
2140 "JRNC DAA2
2141 "ADD (Q0),10H
2142 "ADC (Q1),27H
2143 "MV [X++],(Q6)
2144 "MV (Q6),'/'
2145 "DAA3: INC (Q6)
2146 "SUB (Q0),0E8H
2147 "SBC (Q1),3
2148 "JRNC DAA3
2149 "ADD (Q0),0E8H
2150 "ADC (Q1),3
2151 "MV [X++],(Q6)
2152 "MV (Q6),'/'
2153 "DAA4: INC (Q6)
2154 "SUB (Q0),100
2155 "SBC (Q1),0
2156 "JRNC DAA4
2157 "ADD (Q0),100
2158 "MV [X++],(Q6)
2159 "MV (Q6),'/'
2160 "DAA5: INC (Q6)
2161 "SUB (Q0),10
2162 "JRNC DAA5
2163 "MV [X++],(Q6)
2164 "ADD (Q0),'0'+10
2165 "MV [X++],(Q0)
2166 "MV X,DAADT
2167 "MV (Q0),6
2168 "MV (Q2),' '
2169 "DAA6: MV (Q1),[X]
2170 "CMP (Q1),'0'
2171 "JRNZ DAA7
2172 "MV [X++],(Q2)
2173 "DEC (Q0)
2174 "JRNZ DAA6
2175 "DAA7: POPU I
2176 "RET
2177 "
2178 "EDITR0: MV I,[S++]
2179 "JP EDIT
2180 "
2181 "GC0:
2182 "DW 00000H,00000H,00000H,00000H
2183 "DW 00000H,00000H,00000H,00000H
2184 "DW 00000H,00000H,00000H,00000H
2185 "DW 00000H,00000H,00000H,00000H
2186 "GC1:
2187 "DW 0FC00H,050D8H,04850H,048B4H
2188 "DW 0B448H,05048H,0D850H,000FCH
2189 "DW 06700H,0CDCEH,0FDCCH,0077EH
2190 "DW 07E07H,0CCFDH,0CECDH,00067H
2191 "GC2:
2192 "DW 01000H,044A8H,0D0A4H,0F810H
2193 "DW 010F8H,0A4D0H,0A844H,00010H
2194 "DW 06E00H,0CECFH,0FECEH,0097AH
2195 "DW 07A09H,0CEFEH,0CFCEH,0006EH
2196 "GC3:
2197 "DW 002FCH,01DFDH,095EDH,0B555H
2198 "DW 055B5H,0ED95H,0FD1DH,0FC02H
2199 "DW 0403FH,0B8BFH,0A9B7H,0ADAAH
2200 "DW 0AAADH,0B7A9H,0BFB8H,03F40H
2201 "GC4:
2202 "DW 02418H,09942H,04299H,01824H
2203 "DW 02418H,09942H,04299H,01824H
2204 "DW 02418H,09942H,04299H,01824H
2205 "DW 02418H,09942H,04299H,01824H
2206 "GC5:
2207 "DW 02255H,08855H,02255H,08855H
2208 "DW 02255H,08855H,02255H,08855H
2209 "DW 02255H,08855H,02255H,08855H
2210 "DW 02255H,08855H,02255H,08855H
2211 "GC6:
2212 "DW 00000H,0C080H,0E4E4H,0FEF6H
2213 "DW 0F6FEH,0E4E4H,080C0H,00000H
2214 "DW 0C700H,0FFEFH,01FDFH,03F3FH
2215 "DW 03F3FH,0DF1FH,0EFFFH,000C7H
2216 "GC7:
2217 "DW 00000H,0C080H,064E4H,0FE76H
2218 "DW 076FEH,0E464H,080C0H,00000H
2219 "DW 0C700H,0FFEFH,01EDFH,03F3EH
2220 "DW 03E3FH,0DF1EH,0EFFFH,000C7H
2221 "GC8:
2222 "DW 08000H,08080H,040C0H,0E460H
2223 "DW 0F6F4H,0FEFEH,0E4F6H,080C4H
2224 "DW 0C700H,0EFE7H,09ECFH,0DF9EH
2225 "DW 0FFFFH,09FBFH,08F9FH,00707H
2226 "GC9:
2227 "DW 0C480H,0F6E4H,0FEFEH,0F4F6H
2228 "DW 060E4H,0C040H,08080H,00080H
2229 "DW 00707H,09F8FH,0BF9FH,0FFFFH
2230 "DW 09EDFH,0CF9EH,0E7EFH,000C7H
2231 "GCBOM:
2232 "DW 00000H,00808H,0A2A9H,0C0D4H
2233 "DW 0D4C0H,0A9A2H,00808H,00000H
2234 "DW 0DCE0H,0FFBEH,07B75H,0FFF5H
2235 "DW 0F5FFH,0757BH,0BEFFH,0E0DCH
2236 "GCBOMO:
2237 "DW 0FFFFH,0FFFFH,07F7FH,03F3FH
2238 "DW 03F3FH,07F7FH,0FFFFH,0FFFFH
2239 "DW 0031FH,00001H,00000H,00000H
2240 "DW 00000H,00000H,00100H,01F03H
2241 "GC62:
2242 "DW 00000H,0C080H,0E4E0H,0FEF4H
2243 "DW 0F4FEH,0E0E4H,080C0H,00000H
2244 "DW 0C7C0H,03FEFH,01F1FH,03F3FH
2245 "DW 03F3FH,01F1FH,0EF3FH,0C0C7H
2246 "GC72:
2247 "DW 00000H,0C080H,064E0H,0FE74H
2248 "DW 074FEH,0E064H,080C0H,00000H
2249 "DW 0C7C0H,03FEFH,01E1FH,03F3EH
2250 "DW 03E3FH,01F1EH,0EF3FH,0C0C7H
2251 "GC82:
2252 "DW 08000H,08080H,040C0H,0E060H
2253 "DW 0F4F4H,0FEFEH,0E4F4H,080C0H
2254 "DW 00300H,0C707H,0EEEFH,09FCEH
2255 "DW 0FFBFH,0DFFFH,08F9FH,08787H
2256 "GC92:
2257 "DW 0C080H,0F4E4H,0FEFEH,0F4F4H
2258 "DW 060E0H,0C040H,08080H,00080H
2259 "DW 08787H,09F8FH,0FFDFH,0BFFFH
2260 "DW 0CE9FH,0EFEEH,007C7H,00003H
2261 "GC11:
2262 "DW 0DA67H,0EAFAH,0EEEAH,038EBH
2263 "GC12:
2264 "DW 0CE60H,0FAEAH,0ECE8H,03FC6H
2265 "GC10:
2266 "DW 0DECCH,0BF9EH,07BF5H,07F75H
2267 "
2268 "SCPUT0: CALL SPUT
2269 "MV X,GC0
2270 "JR SCPUT2
2271 "
2272 "SCPUT: OR (G2),0
2273 "JRZ SCPUT0
2274 "MV (G3),(G2)
2275 "MV (G2),5
2276 "CALL SPUT
2277 "MV (G2),(G3)
2278 "MV X,GC11-8
2279 "MV A,(G2)
2280 "MV IL,8
2281 "SCPUT1: ADD X,IL
2282 "DEC A
2283 "JRNZ SCPUT1
2284 "SCPUT2: MV BA,[MYX]
2285 "EX A,B
2286 "ADD A,2
2287 "SUB A,(G1)
2288 "JRC SCPUTR
2289 "CMP A,4
2290 "JRNC SCPUTR
2291 "EX A,B
2292 "ADD A,7
2293 "SUB A,(G0)
2294 "JRC SCPUTR
2295 "JRZ SCPTS0
2296 "CMP A,14
2297 "JRZ SCPTS1
2298 "JRNC SCPUTR
2299 "MV Y,VRAM+448+112-8
2300 "ROL A
2301 "ROL A
2302 "ROL A
2303 "SUB Y,A
2304 "MV A,B
2305 "INC A
2306 "MV IL,112
2307 "SCPUT3: SUB Y,IL
2308 "DEC A
2309 "JRNZ SCPUT3
2310 "MV A,4
2311 "SCPUT4: MV I,[X++]
2312 "MV [Y++],I
2313 "DEC A
2314 "JRNZ SCPUT4
2315 "SCPUT6: MV A,8
2316 "SCPUT5: MV IL,[--X]
2317 "MV [Y++],IL
2318 "DEC A
2319 "JRNZ SCPUT5
2320 "SCPUTR: RET
2321 "
2322 "SCPTS0: MV Y,VRAM+448+112-8
2323 "MV A,B
2324 "INC A
2325 "MV IL,112
2326 "SCPTS2: SUB Y,IL
2327 "DEC A
2328 "JRNZ SCPTS2
2329 "MV A,4
2330 "SCPTS3: MV I,[X++]
2331 "MV [Y++],I
2332 "DEC A
2333 "JRNZ SCPTS3
2334 "RET
2335 "
2336 "SCPTS1: MV Y,VRAM+448
2337 "MV A,B
2338 "INC A
2339 "MV IL,112
2340 "SCPTS4: SUB Y,IL
2341 "DEC A
2342 "JRNZ SCPTS4
2343 "MV A,8
2344 "ADD X,A
2345 "JR SCPUT6
2346 "
2347 "TOROK: MV (RE0),A
2348 "OR A,0
2349 "JRNZ TOROK0
2350 "RET
2351 "TOROK0: DEC (RE0)
2352 "JRZ TR1
2353 "DEC (RE0)
2354 "JRZ TR2
2355 "DEC (RE0)
2356 "JRZ TR3
2357 "DEC (RE0)
2358 "JRNZ TOROK1
2359 "MVW (RE0),[CLR]
2360 "ADD (RE0),4
2361 "ADC (RE1),0
2362 "MVW [CLR],(RE0)
2363 "RET
2364 "TOROK1: DEC (RE0)
2365 "JRZ TOROK2
2366 "MVW (RE0),(R0)
2367 "EX (RE0),(RE1)
2368 "MVW [MYX],(RE0)
2369 "TOROK2: RET
2370 "
2371 "TR1: MV Y,T11+2
2372 "TR10: MV (RE0),[Y]
2373 "OR (RE0),0
2374 "JRZ TR11
2375 "INC Y
2376 "INC Y
2377 "INC Y
2378 "JR TR10
2379 "TR11: MV (RE0),1
2380 "MV [Y],(RE0)
2381 "MV [--Y],(R0)
2382 "MV [--Y],(R1)
2383 "RET
2384 "
2385 "TR2: MV Y,T21+2
2386 "JR TR10
2387 "
2388 "TR3: MV Y,IWA1+2
2389 "JR TR10
2390 "
2391 "PUT: MVP (RE0),GAMN+1
2392 "MV (RE3),A
2393 "MV A,(R1)
2394 "ADD (RE0),A
2395 "ADC (RE1),0
2396 "MV (RE5),(R0)
2397 "INC (RE5)
2398 "PUT0: ADD (RE0),40
2399 "ADC (RE1),0
2400 "DEC (RE5)
2401 "JRNZ PUT0
2402 "MV A,(RE3)
2403 "MV [(RE0)],A
2404 "MV [(RE0)+1],A
2405 "ADD (RE0),40
2406 "ADC (RE1),0
2407 "MV [(RE0)],A
2408 "MV [(RE0)+1],A
2409 "RET
2410 "
2411 "SPUT: MV X,GAMN+1
2412 "MV BA,(G0)
2413 "ADD X,A
2414 "MV A,B
2415 "INC A
2416 "MV IL,40
2417 "SPUT1: ADD X,IL
2418 "DEC A
2419 "JRNZ SPUT1
2420 "MV [X++],(G2)
2421 "MV [X],(G2)
2422 "RET
2423 "
2424 "GATR: PUSHU IMR
2425 "MV (G0),0B8H
2426 "MV [2004H],(G0)
2427 "MV (G1),40H+46
2428 "MV [2004H],(G1)
2429 "MV X,VRAM
2430 "MV Y,2006H
2431 "MV IL,6
2432 "GATR0: MV A,[X++]
2433 "MV [Y],A
2434 "MV A,[X++]
2435 "MV [Y],A
2436 "MV A,[X++]
2437 "MV [Y],A
2438 "DEC IL
2439 "JRNZ GATR0
2440 "INC (G0)
2441 "MV [2004H],(G0)
2442 "MV X,VRAM+112
2443 "MV [2004H],(G1)
2444 "MV IL,6
2445 "GATR1: MV A,[X++]
2446 "MV [Y],A
2447 "MV A,[X++]
2448 "MV [Y],A
2449 "MV A,[X++]
2450 "MV [Y],A
2451 "DEC IL
2452 "JRNZ GATR1
2453 "INC (G0)
2454 "MV [2004H],(G0)
2455 "MV X,VRAM+224
2456 "MV [2004H],(G1)
2457 "MV IL,6
2458 "GATR2: MV A,[X++]
2459 "MV [Y],A
2460 "MV A,[X++]
2461 "MV [Y],A
2462 "MV A,[X++]
2463 "MV [Y],A
2464 "DEC IL
2465 "JRNZ GATR2
2466 "INC (G0)
2467 "MV [2004H],(G0)
2468 "MV X,VRAM+336
2469 "MV [2004H],(G1)
2470 "MV IL,6
2471 "GATR3: MV A,[X++]
2472 "MV [Y],A
2473 "MV A,[X++]
2474 "MV [Y],A
2475 "MV A,[X++]
2476 "MV [Y],A
2477 "DEC IL
2478 "JRNZ GATR3
2479 "MV (G0),0B8H
2480 "MV [2008H],(G0)
2481 "MV (G1),40H
2482 "MV [2008H],(G1)
2483 "MV X,VRAM+18
2484 "MV Y,200AH
2485 "MV IL,8
2486 "GATR4: MV A,[X++]
2487 "MV [Y],A
2488 "MV A,[X++]
2489 "MV [Y],A
2490 "MV A,[X++]
2491 "MV [Y],A
2492 "MV A,[X++]
2493 "MV [Y],A
2494 "MV A,[X++]
2495 "MV [Y],A
2496 "MV A,[X++]
2497 "MV [Y],A
2498 "MV A,[X++]
2499 "MV [Y],A
2500 "DEC IL
2501 "JRNZ GATR4
2502 "INC (G0)
2503 "MV [2008H],(G0)
2504 "MV X,VRAM+130
2505 "MV [2008H],(G1)
2506 "MV IL,8
2507 "GATR5: MV A,[X++]
2508 "MV [Y],A
2509 "MV A,[X++]
2510 "MV [Y],A
2511 "MV A,[X++]
2512 "MV [Y],A
2513 "MV A,[X++]
2514 "MV [Y],A
2515 "MV A,[X++]
2516 "MV [Y],A
2517 "MV A,[X++]
2518 "MV [Y],A
2519 "MV A,[X++]
2520 "MV [Y],A
2521 "DEC IL
2522 "JRNZ GATR5
2523 "INC (G0)
2524 "MV [2008H],(G0)
2525 "MV X,VRAM+242
2526 "MV [2008H],(G1)
2527 "MV IL,8
2528 "GATR6: MV A,[X++]
2529 "MV [Y],A
2530 "MV A,[X++]
2531 "MV [Y],A
2532 "MV A,[X++]
2533 "MV [Y],A
2534 "MV A,[X++]
2535 "MV [Y],A
2536 "MV A,[X++]
2537 "MV [Y],A
2538 "MV A,[X++]
2539 "MV [Y],A
2540 "MV A,[X++]
2541 "MV [Y],A
2542 "DEC IL
2543 "JRNZ GATR6
2544 "INC (G0)
2545 "MV [2008H],(G0)
2546 "MV X,VRAM+354
2547 "MV [2008H],(G1)
2548 "MV IL,8
2549 "GATR7: MV A,[X++]
2550 "MV [Y],A
2551 "MV A,[X++]
2552 "MV [Y],A
2553 "MV A,[X++]
2554 "MV [Y],A
2555 "MV A,[X++]
2556 "MV [Y],A
2557 "MV A,[X++]
2558 "MV [Y],A
2559 "MV A,[X++]
2560 "MV [Y],A
2561 "MV A,[X++]
2562 "MV [Y],A
2563 "DEC IL
2564 "JRNZ GATR7
2565 "INC (G0)
2566 "MV [2008H],(G0)
2567 "MV X,VRAM+112
2568 "MV (G1),40H+18
2569 "MV [2008H],(G1)
2570 "MV IL,6
2571 "GATR8: MV A,[--X]
2572 "MV [Y],A
2573 "MV A,[--X]
2574 "MV [Y],A
2575 "MV A,[--X]
2576 "MV [Y],A
2577 "MV A,[--X]
2578 "MV [Y],A
2579 "MV A,[--X]
2580 "MV [Y],A
2581 "MV A,[--X]
2582 "MV [Y],A
2583 "DEC IL
2584 "JRNZ GATR8
2585 "MV A,[--X]
2586 "MV [Y],A
2587 "MV A,[--X]
2588 "MV [Y],A
2589 "INC (G0)
2590 "MV [2008H],(G0)
2591 "MV X,VRAM+224
2592 "MV [2008H],(G1)
2593 "MV IL,6
2594 "GATR9: MV A,[--X]
2595 "MV [Y],A
2596 "MV A,[--X]
2597 "MV [Y],A
2598 "MV A,[--X]
2599 "MV [Y],A
2600 "MV A,[--X]
2601 "MV [Y],A
2602 "MV A,[--X]
2603 "MV [Y],A
2604 "MV A,[--X]
2605 "MV [Y],A
2606 "DEC IL
2607 "JRNZ GATR9
2608 "MV A,[--X]
2609 "MV [Y],A
2610 "MV A,[--X]
2611 "MV [Y],A
2612 "INC (G0)
2613 "MV [2008H],(G0)
2614 "MV X,VRAM+336
2615 "MV [2008H],(G1)
2616 "MV IL,6
2617 "GATRA: MV A,[--X]
2618 "MV [Y],A
2619 "MV A,[--X]
2620 "MV [Y],A
2621 "MV A,[--X]
2622 "MV [Y],A
2623 "MV A,[--X]
2624 "MV [Y],A
2625 "MV A,[--X]
2626 "MV [Y],A
2627 "MV A,[--X]
2628 "MV [Y],A
2629 "DEC IL
2630 "JRNZ GATRA
2631 "MV A,[--X]
2632 "MV [Y],A
2633 "MV A,[--X]
2634 "MV [Y],A
2635 "INC (G0)
2636 "MV [2008H],(G0)
2637 "MV X,VRAM+448
2638 "MV [2008H],(G1)
2639 "MV IL,6
2640 "GATRB: MV A,[--X]
2641 "MV [Y],A
2642 "MV A,[--X]
2643 "MV [Y],A
2644 "MV A,[--X]
2645 "MV [Y],A
2646 "MV A,[--X]
2647 "MV [Y],A
2648 "MV A,[--X]
2649 "MV [Y],A
2650 "MV A,[--X]
2651 "MV [Y],A
2652 "DEC IL
2653 "JRNZ GATRB
2654 "MV A,[--X]
2655 "MV [Y],A
2656 "MV A,[--X]
2657 "MV [Y],A
2658 "POPU IMR
2659 "RET
2660 "
2661 "GAPUT: MVW (G0),[GAPX]
2662 "MV X,GAMN-45
2663 "MV A,(G0)
2664 "ADD X,A
2665 "MV A,40
2666 "MV IL,(G1)
2667 "INC IL
2668 "GAPUT0: ADD X,A
2669 "DEC IL
2670 "JRNZ GAPUT0
2671 "MV Y,VRAM
2672 "MV (G2),4
2673 "DEC (G1)
2674 "GAPUT1: MV (G3),14
2675 "MV (G4),(G0)
2676 "SUB (G4),6
2677 "GAPUT2: MV A,[X++]
2678 "PUSHU X
2679 "MV IL,8
2680 "CMP (G4),38
2681 "JRNC GAPUT5
2682 "CMP (G1),20
2683 "JRNC GAPUT5
2684 "JR GAPUT3
2685 "GAPUT5: MV A,5
2686 "JR GAPUT4
2687 "GAPUT3: CMP A,6
2688 "JRNC GAPUT6
2689 "CMP A,4
2690 "JRC GAPUT6
2691 "GAPUT4: MV X,GC4
2692 "CMP A,4
2693 "JRZ GAPUT7
2694 "MV X,GC5
2695 "GAPUT7: MV A,[X++]
2696 "MV [Y++],A
2697 "DEC IL
2698 "JRNZ GAPUT7
2699 "JR GAPUT8
2700 "GAPUT6: MV A,0
2701 "GAPUT9: MV [Y++],A
2702 "DEC IL
2703 "JRNZ GAPUT9
2704 "GAPUT8: POPU X
2705 "INC (G4)
2706 "DEC (G3)
2707 "JRNZ GAPUT2
2708 "MV A,26
2709 "ADD X,A
2710 "INC (G1)
2711 "DEC (G2)
2712 "JRNZ GAPUT1
2713 "MVW (G3),[GAPX]
2714 "MVW (G0),[MYX]
2715 "MV (G2),7
2716 "CALL CPUT
2717 "GAPUTG: MV X,T11+2
2718 "MV (G2),1
2719 "MV IL,4
2720 "GAPUTA: MV A,[X]
2721 "OR A,0
2722 "JRZ GAPUTB
2723 "MVW (G0),[--X]
2724 "CALL CPUT
2725 "MV A,5
2726 "ADD X,A
2727 "DEC IL
2728 "JRNZ GAPUTA
2729 "GAPUTB: MV X,T21+2
2730 "INC (G2)
2731 "MV IL,4
2732 "GAPUTC: MV A,[X]
2733 "OR A,0
2734 "JRZ GAPUTD
2735 "MVW (G0),[--X]
2736 "CALL CPUT
2737 "MV A,5
2738 "ADD X,A
2739 "DEC IL
2740 "JRNZ GAPUTC
2741 "GAPUTD: MV X,IWA1+2
2742 "INC (G2)
2743 "MV IL,15
2744 "GAPUTE: MV A,[X]
2745 "OR A,0
2746 "JRZ GAPUTF
2747 "MVW (G0),[--X]
2748 "CALL CPUT
2749 "MV A,5
2750 "ADD X,A
2751 "DEC IL
2752 "JRNZ GAPUTE
2753 "GAPUTF: RET
2754 "
2755 "CPUT: PUSHU X
2756 "PUSHU I
2757 "MV BA,(G3)
2758 "EX A,B
2759 "ADD A,2
2760 "SUB A,(G1)
2761 "JRC CPUTR
2762 "JRZ CPUTS0
2763 "CMP A,4
2764 "JRZ CPUTS1
2765 "JRNC CPUTR
2766 "EX A,B
2767 "ADD A,7
2768 "SUB A,(G0)
2769 "JRC CPUTR
2770 "JRZ CPUTS2
2771 "CMP A,14
2772 "JPZ CPUTS3
2773 "JRNC CPUTR
2774 "MV X,VRAM+448+112-8
2775 "ROL A
2776 "ROL A
2777 "ROL A
2778 "SUB X,A
2779 "MV A,B
2780 "INC A
2781 "MV IL,112
2782 "CPUT0: SUB X,IL
2783 "DEC A
2784 "JRNZ CPUT0
2785 "MV Y,GC0-32
2786 "MV A,(G2)
2787 "INC A
2788 "MV IL,32
2789 "CPUT1: ADD Y,IL
2790 "DEC A
2791 "JRNZ CPUT1
2792 "MV A,(G2)
2793 "CMP A,6
2794 "JRC CPUT2
2795 "CMP A,10
2796 "JRZ CPUT2
2797 "MV A,[MA]
2798 "OR A,0
2799 "JRZ CPUT2
2800 "MV A,192
2801 "ADD Y,A
2802 "CPUT2: MV (G5),2
2803 "MV A,96
2804 "CPUT3: MV (G6),8
2805 "CPUT4: MV I,[Y++]
2806 "MV [X++],I
2807 "DEC (G6)
2808 "JRNZ CPUT4
2809 "ADD X,A
2810 "DEC (G5)
2811 "JRNZ CPUT3
2812 "CPUTR: POPU I
2813 "POPU X
2814 "RET
2815 "
2816 "CPUTY: MV A,(G2)
2817 "INC A
2818 "MV IL,32
2819 "CPUTY1: ADD Y,IL
2820 "DEC A
2821 "JRNZ CPUTY1
2822 "MV A,(G2)
2823 "CMP A,8
2824 "JRC CPUTY2
2825 "CMP A,10
2826 "JRZ CPUTY2
2827 "MV A,[MA]
2828 "OR A,0
2829 "JRZ CPUTY2
2830 "MV A,128
2831 "ADD Y,A
2832 "CPUTY2: RET
2833 "
2834 "CPUTS0: MV A,B
2835 "ADD A,7
2836 "SUB A,(G0)
2837 "JRC CPUTR
2838 "JRZ CPTS0
2839 "CMP A,14
2840 "JRZ CPTS1
2841 "JRNC CPUTR
2842 "MV X,VRAM+448-8
2843 "ROL A
2844 "ROL A
2845 "ROL A
2846 "SUB X,A
2847 "MV Y,GC0-32
2848 "CPUTSS: CALL CPUTY
2849 "MV (G5),1
2850 "JR CPUT3
2851 "
2852 "CPTS0: MV X,VRAM+448-8
2853 "MV Y,GC0-32
2854 "CPTS00: CALL CPUTY
2855 "MV (G5),1
2856 "MV (G6),4
2857 "JR CPUT4
2858 "
2859 "CPTS1: MV X,VRAM+448-112
2860 "MV Y,GC0-24
2861 "JR CPTS00
2862 "
2863 "CPUTS1: MV A,B
2864 "ADD A,7
2865 "SUB A,(G0)
2866 "JRC CPUTR
2867 "JRZ CPTS2
2868 "CMP A,14
2869 "JRZ CPTS3
2870 "JRNC CPUTR
2871 "MV X,VRAM+112-8
2872 "ROL A
2873 "ROL A
2874 "ROL A
2875 "SUB X,A
2876 "MV Y,GC0-16
2877 "JR CPUTSS
2878 "
2879 "CPTS2: MV X,VRAM+112-8
2880 "MV Y,GC0-16
2881 "JR CPTS00
2882 "
2883 "CPTS3: MV X,VRAM
2884 "MV Y,GC0-8
2885 "JR CPTS00
2886 "
2887 "CPUTS2: MV X,VRAM+448-8
2888 "MV A,B
2889 "MV IL,112
2890 "CPTS4: SUB X,IL
2891 "DEC A
2892 "JRNZ CPTS4
2893 "MV Y,GC0-32
2894 "CPTS5: CALL CPUTY
2895 "MV (G5),2
2896 "MV A,104
2897 "CPTS6: MV (G6),4
2898 "CPTS7: MV I,[Y++]
2899 "MV [X++],I
2900 "DEC (G6)
2901 "JRNZ CPTS7
2902 "ADD X,A
2903 "MV IL,8
2904 "ADD Y,IL
2905 "DEC (G5)
2906 "JRNZ CPTS6
2907 "JR CPUTR
2908 "
2909 "CPUTS3: MV X,VRAM+448-112
2910 "MV A,B
2911 "MV IL,112
2912 "CPTS8: SUB X,IL
2913 "DEC A
2914 "JRNZ CPTS8
2915 "MV Y,GC0-24
2916 "JR CPTS5
2917 "
2918 "S3D0: DM 'Time'
2919 "S3D1: DM 'Score'
2920 "S3D2: DM 'High'
2921 "S3D3: DM 'Scene'
2922 "S3D4: DM 'CHANGE :'
2923 "S3D5: DM 'PF1 & PF2'
2924 "S3D6: DM 'PUT : [SPACE]'
2925 "S3D7: DB 7FH,7FH,41H,0,3EH,41H
2926 "DB 41H,41H,22H,0,3EH,41H,41H,41H
2927 "DB 3EH,7FH,9,9,9,6,0,3,4,78H
2928 "DB 4,3,0,41H,7FH,7FH
2929 "S3D8: DB 234,234,234,234
2930 "
2931 "S3: MVW (CX),0
2932 "MV I,51H
2933 "CALL CIOCS
2934 "MV A,0
2935 "MV [MA],A
2936 "MV [PJ],A
2937 "MV [BOM],A
2938 "MV [MENST],A
2939 "MV [MENSS],A
2940 "MV [EMSMC],A
2941 "MV A,7
2942 "MV [MA0],A
2943 "MV I,0
2944 "MV [CLR],I
2945 "MV [MYX],I
2946 "MV I,1500
2947 "MV [TIME],I
2948 "MV X,BGM
2949 "MV [BGMD],X
2950 "MV A,23
2951 "MV X,T11
2952 "MV Y,0
2953 "S30: MV [X++],Y
2954 "DEC A
2955 "JRNZ S30
2956 "MV X,DATA-96
2957 "MV IL,96
2958 "MV A,[MEN]
2959 "S31: ADD X,IL
2960 "DEC A
2961 "JRNZ S31
2962 "MV (R0),0
2963 "S32: MV (R1),0
2964 "S33: MV (R2),[X++]
2965 "MV A,(R2)
2966 "SWAP A
2967 "AND A,0FH
2968 "CALL TOROK
2969 "CALL PUT
2970 "ADD (R0),2
2971 "MV A,(R2)
2972 "AND A,0FH
2973 "CALL TOROK
2974 "CALL PUT
2975 "SUB (R0),2
2976 "ADD (R1),2
2977 "CMP (R1),38
2978 "JRNZ S33
2979 "ADD (R0),4
2980 "CMP (R0),20
2981 "JRNZ S32
2982 "MV A,[CONST]
2983 "OR A,0
2984 "JRNZ S3CNST
2985 "MV I,[MYX]
2986 "MV [GAPX],I
2987 "CALL GAPUT
2988 "CALL GATR
2989 "CALL SSC
2990 "MV I,42H
2991 "MVW (BX),0
2992 "MV X,S3D0
2993 "MV Y,3
2994 "CALL CIOCS
2995 "MV (BL),27
2996 "MV X,S3D2
2997 "MV Y,4
2998 "CALL CIOCS
2999 "MVW (BX),11BH
3000 "MV X,S3D1
3001 "MV Y,5
3002 "CALL CIOCS
3003 "MVW (BX),223H
3004 "MV X,S3D3
3005 "MV Y,5
3006 "CALL CIOCS
3007 "MV A,[MEN]
3008 "MV X,0
3009 "ADD X,A
3010 "CALL DAA
3011 "MVW (BX),326H
3012 "MV X,DAADT+5
3013 "MV Y,2
3014 "CALL CIOCS
3015 "MVW (BX),31BH
3016 "MV X,S3D8
3017 "MV A,[MY]
3018 "DEC A
3019 "JRZ S34
3020 "MV Y,0
3021 "ADD Y,A
3022 "CALL CIOCS
3023 "S34: CALL MENPT
3024 "CALL MENTR
3025 "MV A,16
3026 "MV [TCONT],A
3027 "MV (IMR),81H
3028 "MV (R0),2
3029 "S35: MV A,[MENST]
3030 "OR A,0
3031 "JRZ S35
3032 "S36: MV A,[MENST]
3033 "OR A,0
3034 "JRNZ S36
3035 "DEC (R0)
3036 "JRNZ S35
3037 "MV (IMR),0
3038 "RET
3039 "
3040 "S3CNST: MVW (BX),0
3041 "MV I,42H
3042 "MV X,S3D3
3043 "MV Y,5
3044 "CALL CIOCS
3045 "MV (R0),[MEN]
3046 "MVW (R1),0
3047 "MV X,(R0)
3048 "CALL DAA
3049 "MV (BL),5
3050 "MV X,DAADT+5
3051 "MV Y,2
3052 "CALL CIOCS
3053 "MV (BL),30
3054 "MV X,S3D4
3055 "MV Y,8
3056 "CALL CIOCS
3057 "MVW (BX),11EH
3058 "MV X,S3D5
3059 "MV Y,9
3060 "CALL CIOCS
3061 "MVW (BX),21BH
3062 "MV X,S3D6
3063 "MV Y,13
3064 "CALL CIOCS
3065 "PUSHU IMR
3066 "MV A,0B8H+7
3067 "MV [2008H],A
3068 "MV IL,40H+1
3069 "MV [2008H],IL
3070 "MV X,S3D7+15
3071 "MV IL,15
3072 "S3CNT0: MV A,[--X]
3073 "MV [200AH],A
3074 "DEC IL
3075 "JRNZ S3CNT0
3076 "MV A,0B8H+7
3077 "MV [2004H],A
3078 "MV IL,40H+49
3079 "MV [2004H],IL
3080 "MV X,S3D7+30
3081 "MV IL,15
3082 "S3CNT1: MV A,[--X]
3083 "MV [2006H],A
3084 "DEC IL
3085 "JRNZ S3CNT1
3086 "POPU IMR
3087 "MV I,58H
3088 "MVW (BX),320H
3089 "MV BA,8001H
3090 "MV X,ED5
3091 "CALL CIOCS
3092 "RET
3093 "
3094 "SSC: MV X,[SC]
3095 "MV Y,[HI]
3096 "SUB Y,X
3097 "JRNC SSC0
3098 "MV X,[SC]
3099 "MV [HI],X
3100 "SSC0: MV X,[HI]
3101 "CALL DAA
3102 "MVW (CX),0
3103 "MV I,42H
3104 "MVW (BX),33
3105 "MV X,DAADT
3106 "MV Y,7
3107 "CALL CIOCS
3108 "MV X,[SC]
3109 "CALL DAA
3110 "MVW (BX),121H
3111 "MV X,DAADT
3112 "MV Y,7
3113 "CALL CIOCS
3114 "MVW (BX),3
3115 "MV X,DAADT+3
3116 "MV Y,4
3117 "MV I,[TIME]
3118 "MV BA,999
3119 "SUB BA,I
3120 "JRC SSC1
3121 "JRNZ SSC2
3122 "MVW (BX),3
3123 "MV A,'e'
3124 "MV I,41H
3125 "CALL CIOCS
3126 "MV X,DAADT+3
3127 "MV Y,4
3128 "MV (BL),3
3129 "MV I,[TIME]
3130 "SSC2: INC X
3131 "DEC Y
3132 "INC (BL)
3133 "SSC1: PUSHU X
3134 "MV X,0
3135 "ADD X,I
3136 "CALL DAA
3137 "POPU X
3138 "MV I,42H
3139 "CALL CIOCS
3140 "RET
3141 "
3142 "EDITR: MV I,EDITR0
3143 "MV [SELRT],I
3144 "MV X,ED1
3145 "MV [SELSX],X
3146 "CALL SELCT
3147 "MV A,1
3148 "MV [CHNO],A
3149 "MV A,16
3150 "MV [TCONT],A
3151 "EDITR4: CALL S3
3152 "CALL CHPRNT
3153 "MV I,[MYX]
3154 "MV [GAPX],I
3155 "EDITRS: CALL GAPUT
3156 "MV X,VRAM+160
3157 "MV (R0),2
3158 "EDITR1: MV IL,16
3159 "EDITR2: MV A,[X]
3160 "XOR A,0FFH
3161 "MV [X++],A
3162 "DEC IL
3163 "JRNZ EDITR2
3164 "MV A,96
3165 "ADD X,A
3166 "DEC (R0)
3167 "JRNZ EDITR1
3168 "CALL GATR
3169 "CALL MENPT
3170 "CALL MENTR
3171 "EDITR3: MV (IMR),81H
3172 "CALL KEYIN
3173 "MV (IMR),0
3174 "DEC (R0)
3175 "JPZ CHR1
3176 "DEC (R0)
3177 "JPZ CHR2
3178 "SUB (R0),2
3179 "JPZ COPY
3180 "DEC (R0)
3181 "JPZ EDIT
3182 "DEC (R0)
3183 "JPZ CHPUT
3184 "DEC (R0)
3185 "JRZ CURL
3186 "DEC (R0)
3187 "JRZ CURD
3188 "SUB (R0),2
3189 "JRZ CURU
3190 "DEC (R0)
3191 "JRZ CURR
3192 "DEC (R0)
3193 "JRZ MEND
3194 "DEC (R0)
3195 "JRZ MENU
3196 "DEC (R0)
3197 "JPZ SCRCL
3198 "JR EDITR3
3199 "
3200 "CURD: MV A,[GAPY]
3201 "CMP A,18
3202 "JRZ EDITR3
3203 "ADD A,2
3204 "MV [GAPY],A
3205 "JR EDITRS
3206 "
3207 "CURR: MV A,[GAPX]
3208 "CMP A,36
3209 "JRZ EDITR3
3210 "ADD A,2
3211 "MV [GAPX],A
3212 "JR EDITRS
3213 "
3214 "CURU: MV A,[GAPY]
3215 "OR A,0
3216 "JRZ EDITR3
3217 "SUB A,2
3218 "MV [GAPY],A
3219 "JR EDITRS
3220 "
3221 "CURL: MV A,[GAPX]
3222 "OR A,0
3223 "JRZ EDITR3
3224 "SUB A,2
3225 "MV [GAPX],A
3226 "JR EDITRS
3227 "
3228 "MENU: MV A,[MEN]
3229 "INC A
3230 "CMP A,31
3231 "JRNZ MENU0
3232 "MV A,1
3233 "MENU0: MV [MEN],A
3234 "CALL MENOK
3235 "JRNZ MENU
3236 "JP EDITR4
3237 "
3238 "MEND: MV A,[MEN]
3239 "DEC A
3240 "JRNZ MEND0
3241 "MV A,30
3242 "MEND0: MV [MEN],A
3243 "CALL MENOK
3244 "JRNZ MEND
3245 "JP EDITR4
3246 "
3247 "MENOK: MV A,[MEN]
3248 "MV X,DATA-1
3249 "MV IL,96
3250 "MENOK0: ADD X,IL
3251 "DEC A
3252 "JRNZ MENOK0
3253 "MV A,[X]
3254 "OR A,0
3255 "RET
3256 "
3257 "MGET: MV X,GAMN+41
3258 "MV BA,[GAPX]
3259 "ADD X,A
3260 "MV A,B
3261 "INC A
3262 "MV IL,40
3263 "MGETS0: ADD X,IL
3264 "DEC A
3265 "JRNZ MGETS0
3266 "MV A,[X]
3267 "OR A,0
3268 "JRZ MGETSR
3269 "CMP A,5
3270 "JRZ MGETSR
3271 "CMP A,4
3272 "JRZ MGETSR
3273 "DEC A
3274 "JRZ MGET0
3275 "DEC A
3276 "JRZ MGET1
3277 "DEC A
3278 "JRNZ MGETSR
3279 "MV X,IWA1+2
3280 "MV IL,14
3281 "MGETS2: MV Y,X
3282 "MGETS7: MV A,3
3283 "ADD X,A
3284 "MV A,[X]
3285 "OR A,0
3286 "JRNZ MGETS3
3287 "MV A,3
3288 "SUB X,A
3289 "MGETS4: MV (Q6),[X]
3290 "MV A,0
3291 "MV [X],A
3292 "MV BA,[GAPX]
3293 "DEC Y
3294 "DEC Y
3295 "MGETS5: MV I,[Y]
3296 "SUB I,BA
3297 "JRZ MGETS6
3298 "MV IL,3
3299 "ADD Y,IL
3300 "JR MGETS5
3301 "MGETS6: MV I,[--X]
3302 "MV [Y++],I
3303 "SUB I,BA
3304 "JRZ MGETSR
3305 "MV [Y],(Q6)
3306 "MGETSR: RET
3307 "MGETS3: DEC IL
3308 "JRNZ MGETS7
3309 "JR MGETS4
3310 "
3311 "MGET0: MV X,T11+2
3312 "MGET00: MV IL,3
3313 "JR MGETS2
3314 "
3315 "MGET1: MV X,T21+2
3316 "JR MGET00
3317 "
3318 "SCRCL: MVW (R0),0
3319 "MV A,6
3320 "CALL PUT
3321 "ADD (R1),2
3322 "SCRCL0: MV [GAPX],(R1)
3323 "MV [GAPY],(R0)
3324 "CALL MGET
3325 "MV A,0
3326 "CALL PUT
3327 "ADD (R1),2
3328 "CMP (R1),38
3329 "JRNZ SCRCL0
3330 "MV (R1),0
3331 "ADD (R0),2
3332 "CMP (R0),20
3333 "JRNZ SCRCL0
3334 "CALL MPUT
3335 "MV I,0
3336 "MV [GAPX],I
3337 "MV [MYX],I
3338 "JP EDITRS
3339 "
3340 "MPUT: MV X,DATA-96
3341 "MV A,[MEN]
3342 "MV IL,96
3343 "MPUT0: ADD X,IL
3344 "DEC A
3345 "JRNZ MPUT0
3346 "MV Y,GAMN+41
3347 "MVW (R0),0
3348 "MV IL,80
3349 "MPUT1: MV A,[Y++]
3350 "SWAP A
3351 "MV (R2),A
3352 "ADD Y,IL
3353 "MV A,[Y++]
3354 "OR A,(R2)
3355 "MV [X++],A
3356 "SUB Y,IL
3357 "INC (R0)
3358 "CMP (R0),19
3359 "JRNZ MPUT1
3360 "MV A,122
3361 "ADD Y,A
3362 "MV (R0),0
3363 "INC (R1)
3364 "CMP (R1),5
3365 "JRNZ MPUT1
3366 "RET
3367 "
3368 "COPYD: DM ' COPY'
3369 "DB 0FFH
3370 "
3371 "COPY: MV (G0),[MEN]
3372 "MV I,COPY0
3373 "MV [SELRT],I
3374 "MV X,COPYD
3375 "MV [SELSX],X
3376 "MV A,0
3377 "MV [CONST],A
3378 "CALL SELCT
3379 "MV X,DATA-96
3380 "MV Y,X
3381 "MV IL,96
3382 "MV A,[MEN]
3383 "COPY1: ADD X,IL
3384 "DEC A
3385 "JRNZ COPY1
3386 "MV [MEN],(G0)
3387 "COPY2: ADD Y,IL
3388 "DEC (G0)
3389 "JRNZ COPY2
3390 "DEC IL
3391 "COPY3: MV A,[X++]
3392 "MV [Y++],A
3393 "DEC IL
3394 "JRNZ COPY3
3395 "COPY4: MV A,1
3396 "MV [CONST],A
3397 "JP EDITR4
3398 "COPY0: MV I,[S++]
3399 "JR COPY4
3400 "
3401 "CHPRNT: PUSHU IMR
3402 "MV A,[CHNO]
3403 "INC A
3404 "CMP A,7
3405 "JRNZ CHPR5
3406 "INC A   
3407 "CHPR5: MV X,GC0-18
3408 "MV IL,32
3409 "CHPR0: ADD X,IL
3410 "DEC A
3411 "JRNZ CHPR0
3412 "MV A,0B8H+4
3413 "MV [2008H],A
3414 "MV IL,40H
3415 "MV [2008H],IL
3416 "MV IL,14
3417 "CHPR1: MV A,[--X]
3418 "MV [200AH],A
3419 "DEC IL
3420 "JRNZ CHPR1
3421 "MV A,30
3422 "ADD X,A
3423 "MV A,0B8H+5
3424 "MV [2008H],A
3425 "MV IL,40H
3426 "MV [2008H],IL
3427 "MV IL,14
3428 "CHPR2: MV A,[--X]
3429 "MV [200AH],A
3430 "DEC IL
3431 "JRNZ CHPR2
3432 "MV A,0B8H+4
3433 "MV [2004H],A
3434 "MV IL,40H+62
3435 "MV [2004H],IL
3436 "MV IL,2
3437 "CHPR3: MV A,[--X]
3438 "MV [2006H],A
3439 "DEC IL
3440 "JRNZ CHPR3
3441 "MV A,18
3442 "ADD X,A
3443 "MV A,0B8H+5
3444 "MV [2004H],A
3445 "MV IL,40H+62
3446 "MV [2004H],IL
3447 "MV IL,2
3448 "CHPR4: MV A,[--X]
3449 "MV [2006H],A
3450 "DEC IL
3451 "JRNZ CHPR4
3452 "POPU IMR
3453 "RET
3454 "
3455 "CHR1: MV A,[CHNO]
3456 "DEC A
3457 "CMP A,-1
3458 "JRNZ CHR10
3459 "MV A,6
3460 "CHR10: MV [CHNO],A
3461 "CALL CHPRNT
3462 "JP EDITR3
3463 "
3464 "CHR2: MV A,[CHNO]
3465 "INC A
3466 "CMP A,7
3467 "JRNZ CHR10
3468 "MV A,0
3469 "JR CHR10
3470 "
3471 "CHPUT: MV BA,[GAPX]
3472 "CALL XHLS
3473 "MV A,[X]
3474 "CMP A,6
3475 "JPZ EDITR3
3476 "MV A,[CHNO]
3477 "DEC A
3478 "JRZ CHRP1
3479 "DEC A
3480 "JRZ CHRP2
3481 "DEC A
3482 "JRZ CHRP3
3483 "CMP A,3
3484 "JRNZ CHPUT0
3485 "MV BA,[MYX]
3486 "EX A,B
3487 "MV (R0),BA
3488 "MV A,0
3489 "CALL PUT
3490 "MV I,[GAPX]
3491 "MV [MYX],I
3492 "CHPUT0: CALL MGET
3493 "MV BA,[GAPX]
3494 "MV (R1),A
3495 "MV A,B
3496 "MV (R0),A
3497 "MV A,[CHNO]
3498 "CALL PUT
3499 "CALL MPUT
3500 "JP EDITRS
3501 "
3502 "CHRP1: MV X,T11-1
3503 "CHRP10: MV IL,4
3504 "CHRP11: MV A,3
3505 "CHRP12: ADD X,A
3506 "MV (R0),[X]
3507 "OR (R0),0
3508 "JRZ CHRP13
3509 "DEC IL
3510 "JRNZ CHRP12
3511 "JP EDITR3
3512 "CHRP13: INC (R0)
3513 "MV [X],(R0)
3514 "DEC X
3515 "DEC X
3516 "MV I,[GAPX]
3517 "MV [X],I
3518 "JR CHPUT0
3519 "
3520 "CHRP2: MV X,T21-1
3521 "JR CHRP10
3522 "
3523 "CHRP3: MV X,IWA1-1
3524 "MV IL,15
3525 "JR CHRP11
3526 "
3527 "MENTR: PUSHU IMR
3528 "MV X,MVRAM
3529 "MV Y,2006H
3530 "MV A,0B8H+1
3531 "MENTR0: MV [2004H],A
3532 "MV B,A
3533 "MV IL,40H
3534 "MV [2004H],IL
3535 "MV IL,7
3536 "MENTR1: MV A,[X++]
3537 "MV [Y],A
3538 "MV A,[X++]
3539 "MV [Y],A
3540 "MV A,[X++]
3541 "MV [Y],A
3542 "MV A,[X++]
3543 "MV [Y],A
3544 "MV A,[X++]
3545 "MV [Y],A
3546 "MV A,[X++]
3547 "MV [Y],A
3548 "DEC IL
3549 "JRNZ MENTR1
3550 "MV A,B
3551 "INC A
3552 "CMP A,0B8H+4
3553 "JRNZ MENTR0
3554 "POPU IMR
3555 "RET
3556 "
3557 "MENPT: MV X,MVRAM
3558 "MV BA,0FFFFH
3559 "MV IL,63
3560 "MENPT0: MV [X++],BA
3561 "DEC IL
3562 "JRNZ MENPT0
3563 "MV (GR0),0FBH
3564 "MV (GR6),20
3565 "MV Y,GAMN+41
3566 "MVP (GR3),MVRAM+2
3567 "MV A,[MENST]
3568 "MV (GR7),A
3569 "MV A,[MENSS]
3570 "MV (GR8),A
3571 "MENPT1: MV X,(GR3)
3572 "MV IL,38
3573 "MENPT2: MV A,[X]
3574 "MV (GR1),[Y++]
3575 "CMP (GR1),5
3576 "JRZ MENPT3
3577 "CMP (GR1),4
3578 "JRNZ MENPTA
3579 "CMP (GR8),80H
3580 "JRNC MENPT3
3581 "JR MENPTB
3582 "MENPTA: OR (GR1),0
3583 "JRZ MENPTB
3584 "OR (GR7),0
3585 "JRZ MENPT3
3586 "MENPTB: AND A,(GR0)
3587 "MENPT3: MV [X++],A
3588 "DEC IL
3589 "JRNZ MENPT2
3590 "DEC (GR6)
3591 "JRNZ MENPT4
3592 "RET
3593 "MENPT4: INC Y
3594 "INC Y
3595 "ROL (GR0)
3596 "JRC MENPT1
3597 "ADD (GR3),42
3598 "ADC (GR4),0
3599 "JR MENPT1
3600 "
3601 "MUON: DB 10H
3602 "MUON0: DB 0
3603 "ONCHO: DB '0'
3604 "MUTBL: DB 'C',244,16,'D',218,18
3605 "DB 'E',194,20,'F',183,21
3606 "DB 'G',163,24,'A',145,26
3607 "DB 'B',129,30,'R',244,16
3608 "MUTB: DB 1,2,3,4,6,8,12,16,24,32
3609 "
3610 "MUSIC: MV A,2
3611 "MV [MUOCT],A
3612 "MUSIC0: MV A,[X++]
3613 "CMP A,'/'
3614 "JRNZ MUSIC4
3615 "RET
3616 "MUSIC4: CMP A,'+'
3617 "JRZ MUSIC1
3618 "CMP A,'-'
3619 "JRNZ MUSIC2
3620 "MV A,1
3621 "MUSIC3: MV [MUOCT],A
3622 "JR MUSIC0
3623 "MUSIC1: MV A,3
3624 "JR MUSIC3
3625 "MUSIC2: MV Y,MUTBL
3626 "MV (R2),A
3627 "MV (R3),1
3628 "CMP A,'R'
3629 "JRNZ MUSIC5
3630 "MV (R3),A
3631 "MUSIC5: MV A,[Y++]
3632 "CMP (R2),A
3633 "JRZ MUSIC6
3634 "INC Y
3635 "INC Y
3636 "JR MUSIC5
3637 "MUSIC6: MV A,0
3638 "MV B,A
3639 "MV A,[Y++]
3640 "MV IL,[MUOCT]
3641 "MV (R2),IL
3642 "DEC IL
3643 "JRNZ MUSIC7
3644 "ADD BA,BA
3645 "JR MUSIC8
3646 "MUSIC7: DEC IL
3647 "JRZ MUSIC8
3648 "RC
3649 "SHR A
3650 "MUSIC8: MV (R0),BA
3651 "MV A,[Y]
3652 "DEC (R2)
3653 "JRNZ MUSIC9
3654 "RC
3655 "SHR A
3656 "JR MUSICA
3657 "MUSIC9: DEC (R2)
3658 "JRZ MUSICA
3659 "ROL A
3660 "MUSICA: MV B,A
3661 "MV A,[X]
3662 "CMP A,'0'
3663 "JRC MUSICB
3664 "CMP A,'9'+1
3665 "JRNC MUSICB
3666 "INC X
3667 "MV [ONCHO],A
3668 "JR MUSICC
3669 "MUSICB: MV A,[ONCHO]
3670 "MUSICC: SUB A,'0'
3671 "MV Y,MUTB
3672 "ADD Y,A
3673 "MV IL,[Y]
3674 "MV Y,0
3675 "MV A,B
3676 "MUSICD: ADD Y,A
3677 "DEC IL
3678 "JRNZ MUSICD
3679 "AND (0FDH),8FH
3680 "MV A,[MUON]
3681 "DEC (R3)
3682 "JRZ MU0
3683 "MV A,0
3684 "MU0: MV I,(R0)
3685 "XOR (0FDH),A
3686 "MU1: DEC I
3687 "JRNZ MU1
3688 "DEC Y
3689 "JRNZ MU0
3690 "JR MUSIC
3691 "
3692 "BOMY: MV X,VRAM+160
3693 "MV Y,GCBOMO
3694 "MV (R1),2
3695 "BOMY2: MV IL,16
3696 "BOMY1: MV A,[X]
3697 "MV (R0),[Y++]
3698 "AND A,(R0)
3699 "MV [X++],A
3700 "DEC IL
3701 "JRNZ BOMY1
3702 "MV IL,96
3703 "ADD X,IL
3704 "DEC (R1)
3705 "JRNZ BOMY2
3706 "MV X,VRAM+160
3707 "MV Y,GCBOM
3708 "MV (R1),2
3709 "BOMY6: MV IL,16
3710 "BOMY7: MV A,[X]
3711 "MV (R0),[Y++]
3712 "OR A,(R0)
3713 "MV [X++],A
3714 "DEC IL
3715 "JRNZ BOMY7
3716 "MV IL,96
3717 "ADD X,IL
3718 "DEC (R1)
3719 "JRNZ BOMY6
3720 "CALL GATR
3721 "BOMY0: MV (G0),28
3722 "BOMY5: MV X,MS1
3723 "CALL MUSIC
3724 "DEC (G0)
3725 "JRNZ BOMY5
3726 "MV X,MS1+6
3727 "CALL MUSIC
3728 "MV A,[MY]
3729 "DEC A
3730 "MV [MY],A
3731 "JPNZ L1
3732 "MV X,MS2
3733 "CALL MUSIC
3734 "MV X,VRAM
3735 "MV BA,0
3736 "MV IL,224
3737 "BOMY3: MV [X++],BA
3738 "DEC IL
3739 "JRNZ BOMY3
3740 "CALL GATR
3741 "MVW (CX),0
3742 "MV I,42H
3743 "MVW (BX),20DH
3744 "MV X,BOMYD
3745 "MV Y,9
3746 "CALL CIOCS
3747 "MV (IMR),81H
3748 "MV X,270000
3749 "BOMY4: DEC X
3750 "JRNZ BOMY4
3751 "MV (IMR),0
3752 "JP L0
3753 "
3754 "MS1: DM '-C0-D/-C/'
3755 "MS2: DM 'R9+B2+A+G+F+E+D+CBAGFE'
3756 "DM 'DC-B-A-G-F-E-D-C-D-E-F-G-A'
3757 "DM '-BR-C9/'
3758 "BOMYD: DM 'GAME OVER'
3759 "
3760 "CLR1: MVW (R0),[TIME]
3761 "MV (R2),0
3762 "MV X,(R0)
3763 "CALL DAA
3764 "MV I,(R0)
3765 "MV A,[DAADT+6]
3766 "SUB A,'0'
3767 "SUB I,A
3768 "MV X,[SC]
3769 "ADD X,I
3770 "MV [SC],X
3771 "CALL SSC
3772 "MV X,33750
3773 "MV (IMR),81H
3774 "CLR10: DEC X
3775 "JRNZ CLR10
3776 "MV (IMR),0
3777 "MV (RE0),3
3778 "CLR16: MV X,MS3
3779 "CALL MUSIC
3780 "DEC (RE0)
3781 "JRNZ CLR16
3782 "MV X,MS7
3783 "CALL MUSIC
3784 "MV A,[MEN]
3785 "INC A
3786 "MV [MEN],A
3787 "MV X,DATA-97
3788 "MV IL,96
3789 "CLR11: ADD X,IL
3790 "DEC A
3791 "JRNZ CLR11
3792 "MV A,[X]
3793 "OR A,0
3794 "JRZ CLR12
3795 "MV A,0
3796 "MV [X],A
3797 "MV X,DATA+95
3798 "MV (R0),30
3799 "MV (R1),0
3800 "CLR13: MV A,[X]
3801 "OR A,0
3802 "JRZ CLR14
3803 "INC (R1)
3804 "CLR14: ADD X,IL
3805 "DEC (R0)
3806 "JRNZ CLR13
3807 "OR (R1),0
3808 "JRZ CLEAR
3809 "CLR12: MV X,33750
3810 "MV (IMR),81H
3811 "CLR15: DEC X
3812 "JRNZ CLR15
3813 "MV (IMR),0
3814 "JP L1
3815 "
3816 "MS3: DM 'B2AGBDGBAFB/'
3817 "MS7: DM 'B0B3B8/'
3818 "
3819 "CLEAR: MV (IMR),81H
3820 "MV X,270000
3821 "CLEAR3: DEC X
3822 "JRNZ CLEAR3
3823 "MV (IMR),0
3824 "MVW (CX),0
3825 "MV I,51H
3826 "CALL CIOCS
3827 "MV I,42H
3828 "MVW (BX),11
3829 "MV X,CRD1
3830 "MV Y,18
3831 "CALL CIOCS
3832 "MVW (BX),100H
3833 "MV X,CRD2
3834 "MV Y,40
3835 "CALL CIOCS
3836 "MVW (BX),205H
3837 "MV X,CRD3
3838 "MV Y,29
3839 "CALL CIOCS
3840 "MV (RE0),3
3841 "CLEAR0: MV (RE1),3
3842 "CLEAR1: MV X,MS3
3843 "CALL MUSIC
3844 "DEC (RE1)
3845 "JRNZ CLEAR1
3846 "MV X,MS7
3847 "CALL MUSIC
3848 "DEC (RE0)
3849 "JRNZ CLEAR0
3850 "MV I,42H
3851 "MVW (BX),30CH
3852 "MV X,CRD4
3853 "MV Y,16
3854 "CALL CIOCS
3855 "CLEAR2: CALL KEYIN
3856 "CMP (R0),6
3857 "JRNZ CLEAR2
3858 "JP L0
3859 "
3860 "CRD1: DM 'Congratulations !!'
3861 "CRD2: DM 'You cleared all 30 scenes of this game !'
3862 "CRD3: DM 'Let'
3863 "DB '''
3864 "DM 's try again '
3865 "DB '''
3866 "DM 'XETTER E500'
3867 "DB '''
3868 "CRD4: DM 'PUSH [SPACE] KEY'
3869 "
3870 "BGM: DM 'GGFEDGGFEDGGFEDGGABGGFEDGGFEDGGFEDGGABBGBGBGGABAFAFAFEDCBGBGBGGABAFAFAFEDC/'
3871 "
3872 "IMOVE: MV Y,BGMD
3873 "MV X,[Y]
3874 "IMOVE0: MV A,[X++]
3875 "CMP A,'/'
3876 "JRNZ IMOVE1
3877 "MV X,BGM
3878 "JR IMOVE0
3879 "IMOVE1: MV [Y++],A
3880 "MV I,'/0'
3881 "MV [Y],I
3882 "MV (RE0),X
3883 "MV X,Y
3884 "DEC X
3885 "MV A,[MUON0]
3886 "DEC A
3887 "JRZ IMOVEA
3888 "CALL MUSIC
3889 "IMOVEA: MV (KO1),4
3890 "MV (KO),0
3891 "MVP [BGMD],(RE0)
3892 "MV (R0),(KI)
3893 "MV (KO1),0
3894 "MV (KO),1
3895 "MV A,(R0)
3896 "AND A,40H
3897 "JRZ IMOVE2
3898 "MV A,10H
3899 "MV [MUON],A
3900 "MV A,0
3901 "MV [MUON0],A
3902 "IMOVE2: MV A,(R0)
3903 "AND A,20H
3904 "JRZ IMOVE3
3905 "MV A,10H
3906 "MV [MUON],A
3907 "MV A,1
3908 "MV [MUON0],A
3909 "IMOVE3: AND (R0),10H
3910 "JRZ IMOVEZ
3911 "MV A,0
3912 "MV [MUON],A
3913 "MV A,1
3914 "MV [MUON0],A
3915 "IMOVEZ: MV (R0),(KI)
3916 "MV (KO),80H
3917 "MV A,(R0)
3918 "AND A,10H
3919 "JPNZ BASIC
3920 "AND (R0),40H
3921 "MV (R1),(KI)
3922 "MV (KO),40H
3923 "MV A,(R1)
3924 "AND A,1
3925 "JRZ IMOVE4
3926 "MVW (G0),[MYX]
3927 "MVW (G3),(G0)
3928 "MV (G2),0
3929 "CALL CPUT
3930 "MV A,1
3931 "MV [BOM],A
3932 "OR (R0),0
3933 "JRZ IMOVER
3934 "MV [MY],A
3935 "JR IMOVER
3936 "IMOVE4: AND (R1),20H
3937 "JPNZ IM6
3938 "MV (R0),(KI)
3939 "MV (KO),20H
3940 "MV A,(R0)
3941 "AND A,10H
3942 "JRNZ IM8
3943 "AND (R0),40H
3944 "JRNZ IM2
3945 "MV A,(KI)
3946 "AND A,20H
3947 "JPNZ IM4
3948 "IMOVER: RET
3949 "
3950 "XHL: MV BA,[MYX]
3951 "XHLS: MV X,GAMN+1
3952 "ADD X,A
3953 "MV A,B
3954 "INC A
3955 "MV IL,40
3956 "XHL0: ADD X,IL
3957 "DEC A
3958 "JRNZ XHL0
3959 "RET
3960 "
3961 "IM2: CALL XHL
3962 "MV A,7
3963 "MV [MA1],A
3964 "MV I,100H
3965 "MV [MAXY],I
3966 "MV A,80
3967 "ADD X,A
3968 "IM23: MVW (R0),[X]
3969 "IM24: CMP (R0),(R1)
3970 "JPNZ IM2S
3971 "DEC (R0)
3972 "JRNZ IM20
3973 "IM21: MV A,1
3974 "MV [BOM],A
3975 "JR IM2PS
3976 "IM20: DEC (R0)
3977 "JRZ IM21
3978 "DEC (R0)
3979 "JRNZ IM25
3980 "MV A,[MA1]
3981 "CMP A,8
3982 "JRC IM2P0
3983 "JP IM4E
3984 "IM25: DEC (R0)
3985 "JRNZ IM22
3986 "MV I,[CLR]
3987 "DEC I
3988 "DEC I
3989 "MV [CLR],I
3990 "MV X,[SC]
3991 "MV A,20
3992 "ADD X,A
3993 "MV [SC],X
3994 "JR IM2PS
3995 "IM22: DEC (R0)
3996 "JRZ IM2P0
3997 "IM2PS: MVW (R0),[MYX]
3998 "MVW (G0),(R0)
3999 "MVW (G3),(R0)
4000 "EX (R0),(R1)
4001 "MV A,0
4002 "MV (G2),A
4003 "CALL PUT
4004 "CALL CPUT
4005 "MVW (R0),[MYX]
4006 "MV BA,[MAXY]
4007 "ADD (R0),A
4008 "MV A,B
4009 "ADD (R1),A
4010 "MVW [MYX],(R0)
4011 "CALL SCROL
4012 "MV A,[MA]
4013 "XOR A,0FFH
4014 "MV [MA],A
4015 "IM2P: MVW (R0),[MYX]
4016 "MVW (G0),(R0)
4017 "MVW (G3),(R0)
4018 "EX (R0),(R1)
4019 "MV A,6
4020 "CALL PUT
4021 "MV A,[MA1]
4022 "MV [MA0],A
4023 "MV (G2),A
4024 "MV A,[BOM]
4025 "DEC A
4026 "JRZ IM2PG
4027 "CALL CPUT
4028 "IM2PG: CALL GATR
4029 "RET
4030 "
4031 "IM2P0: MVW (R0),[MA0]
4032 "CMP (R0),(R1)
4033 "JRNZ IM2P
4034 "RET
4035 "
4036 "IM8: CALL XHL
4037 "MV A,6
4038 "MV [MA1],A
4039 "MV I,0FF00H
4040 "MV [MAXY],I
4041 "MV A,40
4042 "SUB X,A
4043 "JR IM23
4044 "
4045 "IM6: CALL XHL
4046 "MV A,9
4047 "MV [MA1],A
4048 "MV I,1
4049 "MV [MAXY],I
4050 "INC X
4051 "INC X
4052 "IM60: MV (R0),[X]
4053 "MV A,40
4054 "ADD X,A
4055 "MV (R1),[X]
4056 "JR IM24
4057 "
4058 "IM4: CALL XHL
4059 "MV A,8
4060 "MV [MA1],A
4061 "MV I,0FFH
4062 "MV [MAXY],I
4063 "DEC X
4064 "JR IM60
4065 "
4066 "IM2S: MV A,(R0)
4067 "CMP (R1),A
4068 "JRNC IM2S0
4069 "EX (R0),(R1)
4070 "IM2S0: CMP (R1),5
4071 "JRZ IM2P0
4072 "CMP (R0),3
4073 "JRZ IM2P0
4074 "CMP (R1),3
4075 "JRZ IM2P0
4076 "CMP (R1),4
4077 "JRNZ IM2S1
4078 "MV I,[CLR]
4079 "DEC I
4080 "MV [CLR],I
4081 "MV X,[SC]
4082 "MV A,10
4083 "ADD X,A
4084 "MV [SC],X
4085 "OR (R0),0
4086 "JRZ IM2PS
4087 "IM2S1: MV A,1
4088 "MV [BOM],A
4089 "JP IM2PS
4090 "
4091 "IM4E: CALL XHL
4092 "MV (R2),[MA1]
4093 "CMP (R2),8
4094 "JRZ IM4E0
4095 "MV A,4
4096 "ADD X,A
4097 "JR IM4E1
4098 "IM4E0: MV A,3
4099 "SUB X,A
4100 "IM4E1: MV (R0),[X]
4101 "MV A,40
4102 "ADD X,A
4103 "MV A,[X]
4104 "ADD A,(R0)
4105 "JRNZ IM2P0
4106 "MV BA,[MYX]
4107 "CMP (R2),8
4108 "JRZ IM4E2
4109 "INC A
4110 "INC A
4111 "JR IM4E3
4112 "IM4E2: DEC A
4113 "DEC A
4114 "IM4E3: MV X,IWA1
4115 "MV (R1),15
4116 "ISH0: MV I,[X]
4117 "SUB I,BA
4118 "JRZ IM4E4
4119 "DEC (R1)
4120 "JRZ IM2P0
4121 "INC X
4122 "INC X
4123 "MV (R0),[X++]
4124 "OR (R0),0
4125 "JRZ IM2P0
4126 "JR ISH0
4127 "IM4E4: CMP (R2),8
4128 "JRZ IM4E5
4129 "INC A
4130 "JR IM4E6
4131 "IM4E5: DEC A
4132 "IM4E6: MV [X],BA
4133 "MV (G0),BA
4134 "EX A,B
4135 "MV (R0),BA
4136 "MV A,3
4137 "MV (G2),A
4138 "CALL PUT
4139 "MV I,[MYX]
4140 "MV (G3),I
4141 "CALL CPUT
4142 "JP IM2PS
4143 "
4144 "SCROL: MV A,[MA1]
4145 "CMP A,6
4146 "JPZ SCROLU
4147 "CMP A,7
4148 "JRZ SCROLD
4149 "CMP A,9
4150 "JRZ SCROLR
4151 "MV X,VRAM+448
4152 "MV Y,VRAM+440
4153 "MV (R0),4
4154 "SCLL0: MV A,52
4155 "SCLL1: MV I,[--Y]
4156 "MV [--X],I
4157 "DEC A
4158 "JRNZ SCLL1
4159 "MV A,8
4160 "SUB X,A
4161 "SUB Y,A
4162 "DEC (R0)
4163 "JRNZ SCLL0
4164 "MV X,VRAM
4165 "MV BA,[MYX]
4166 "MV (R0),0
4167 "CMP A,6
4168 "JRNC SCLL3
4169 "INC (R0)
4170 "SCLL3: MV Y,GAMN-45
4171 "SCLL4: ADD Y,A
4172 "MV A,B
4173 "INC A
4174 "MV IL,40
4175 "SCLL2: ADD Y,IL
4176 "DEC A
4177 "JRNZ SCLL2
4178 "MV (R1),4
4179 "SCLL5: MV A,[Y]
4180 "PUSHU Y
4181 "MV Y,GC5
4182 "OR (R0),0
4183 "JRNZ SCLL6
4184 "CMP A,5
4185 "JRZ SCLL6
4186 "CMP A,4
4187 "JRNZ SCLL7
4188 "MV Y,GC4
4189 "JR SCLL6
4190 "SCLL7: MV Y,GC0
4191 "SCLL6: MV A,4
4192 "SCLL8: MV I,[Y++]
4193 "MV [X++],I
4194 "DEC A
4195 "JRNZ SCLL8
4196 "POPU Y
4197 "MV A,40
4198 "ADD Y,A
4199 "MV A,104
4200 "ADD X,A
4201 "DEC (R1)
4202 "JRNZ SCLL5
4203 "SCLLA: MVW (G0),[MYX]
4204 "MVW (G3),(G0)
4205 "JP GAPUTG
4206 "
4207 "SCROLR: MV X,VRAM
4208 "MV Y,VRAM+8
4209 "MV (R0),4
4210 "SCLR0: MV A,52
4211 "SCLR1: MV I,[Y++]
4212 "MV [X++],I
4213 "DEC A
4214 "JRNZ SCLR1
4215 "MV A,8
4216 "ADD X,A
4217 "ADD Y,A
4218 "DEC (R0)
4219 "JRNZ SCLR0
4220 "MV X,VRAM+104
4221 "MV BA,[MYX]
4222 "MV (R0),0
4223 "CMP A,32
4224 "JRC SCLR3
4225 "INC (R0)
4226 "SCLR3: MV Y,GAMN-32
4227 "JR SCLL4
4228 "
4229 "SCROLD: MV X,VRAM
4230 "MV Y,VRAM+112
4231 "MV A,168
4232 "SCLD0: MV I,[Y++]
4233 "MV [X++],I
4234 "DEC A
4235 "JRNZ SCLD0
4236 "MV X,VRAM+336
4237 "MV Y,GAMN+75
4238 "SCLD7: MV BA,[MYX]
4239 "MV (R0),A
4240 "ADD Y,A
4241 "MV A,B
4242 "INC A
4243 "MV IL,40
4244 "SCLD2: ADD Y,IL
4245 "DEC A
4246 "JRNZ SCLD2
4247 "MV (R1),14
4248 "SCLD3: MV A,[Y++]
4249 "PUSHU Y
4250 "MV Y,GC5
4251 "CMP (R0),6
4252 "JRC SCLD4
4253 "CMP (R0),45
4254 "JRNC SCLD4
4255 "CMP A,5
4256 "JRZ SCLD4
4257 "CMP A,4
4258 "JRNZ SCLD5
4259 "MV Y,GC4
4260 "JR SCLD4
4261 "SCLD5: MV Y,GC0
4262 "SCLD4: MV A,4
4263 "SCLD6: MV I,[Y++]
4264 "MV [X++],I
4265 "DEC A
4266 "JRNZ SCLD6
4267 "POPU Y
4268 "INC (R0)
4269 "DEC (R1)
4270 "JRNZ SCLD3
4271 "JR SCLLA
4272 "
4273 "SCROLU: MV X,VRAM+448
4274 "MV Y,VRAM+336
4275 "MV A,168
4276 "SCLU0: MV I,[--Y]
4277 "MV [--X],I
4278 "DEC A
4279 "JRNZ SCLU0
4280 "MV X,VRAM
4281 "MV Y,GAMN-45
4282 "JR SCLD7
4283 "
4284 "EMOVE: MV X,IWA1+2
4285 "MVW (Q0),15
4286 "EMOVE0: MV A,[X]
4287 "OR A,0
4288 "JRZ EMOVER
4289 "DEC X
4290 "DEC X
4291 "CALL EMS
4292 "MV A,[BOM]
4293 "DEC A
4294 "JRZ EMOVER
4295 "MV A,5
4296 "ADD X,A
4297 "DEC (Q0)
4298 "JRNZ EMOVE0
4299 "EMOVER: OR (Q1),0
4300 "JRZ EMOVES
4301 "CALL GATR
4302 "EMOVES: RET
4303 "
4304 "EMS: PUSHU X
4305 "MV BA,[X]
4306 "MV (Q2),BA
4307 "EX A,B
4308 "ADD A,2
4309 "EX A,B
4310 "CALL XHLS
4311 "MV BA,[X]
4312 "MV IL,2
4313 "EMSE0: CMP A,5
4314 "JRZ EMSR
4315 "CMP A,4
4316 "JRZ EMSR
4317 "CMP A,3
4318 "JRZ EMSR
4319 "EX A,B
4320 "DEC IL
4321 "JRNZ EMSE0
4322 "INC BA
4323 "DEC BA
4324 "JRZ EMS1
4325 "CALL EMS0
4326 "EMS1: MV (R0),(Q3)
4327 "MV (R1),(Q2)
4328 "MV A,0
4329 "MVW (G0),(Q2)
4330 "MV (G2),A
4331 "CALL PUT
4332 "MVW (G3),[MYX]
4333 "CALL CPUT
4334 "INC (R0)
4335 "MV A,3
4336 "MV (G2),A
4337 "CALL PUT
4338 "INC (G1)
4339 "CALL CPUT
4340 "MV X,[U]
4341 "MVW [X],(G0)
4342 "MV (Q1),1
4343 "EMS2: MV A,[EMSMC]
4344 "OR A,0
4345 "JRZ EMSR
4346 "DEC A
4347 "MV [EMSMC],A
4348 "CALL GATR
4349 "MV X,MS
4350 "CALL MUSIC
4351 "JR EMS2
4352 "EMSR: POPU X
4353 "RET
4354 "
4355 "MS: DM '+C1+E+G/'
4356 "
4357 "EMS0: MV (RE0),BA
4358 "CMP (RE0),(RE1)
4359 "JRNZ EMS0S
4360 "CMP A,6
4361 "JRZ IDED
4362 "MV BA,(Q2)
4363 "EX A,B
4364 "ADD A,2
4365 "EX A,B
4366 "CALL ESECH
4367 "JRZ EMS0S
4368 "MV (R2),1
4369 "JR EMS0S3
4370 "
4371 "IDED: MV A,1
4372 "MV [BOM],A
4373 "MVW (G0),[MYX]
4374 "MV (G2),0
4375 "CALL SCPUT
4376 "INC (G1)
4377 "MV (G2),3
4378 "CALL SCPUT
4379 "RET
4380 "
4381 "ESECH: MV X,T11
4382 "MV (RE2),8
4383 "ESE: MV I,[X++]
4384 "MV (RE3),[X++]
4385 "DEC (RE3)
4386 "JRNZ ESES
4387 "SUB I,BA
4388 "JRNZ ESES
4389 "MV A,3
4390 "SUB X,A
4391 "RET
4392 "ESES: DEC (RE2)
4393 "JRNZ ESE
4394 "RET
4395 "
4396 "EMS0S: MV BA,(Q2)
4397 "DEC A
4398 "EX A,B
4399 "ADD A,2
4400 "EX A,B
4401 "MV (R0),BA
4402 "MV (R2),2
4403 "EMS0S0: CMP (RE0),6
4404 "JRNZ EMS0S1
4405 "CALL IDED
4406 "JR EMS0S2
4407 "EMS0S1: MV BA,(R0)
4408 "CALL ESECH
4409 "JRZ EMS0S2
4410 "EMS0S3: MV A,[EMSMC]
4411 "INC A
4412 "MV [EMSMC],A
4413 "MVW (G0),[X]
4414 "INC X
4415 "MV A,[X]
4416 "INC A
4417 "MV [X++],A
4418 "MV A,2
4419 "MV [X],A
4420 "MV (G2),0
4421 "CALL SCPUT
4422 "INC (G1)
4423 "MV (G2),(RE0)
4424 "CALL SCPUT
4425 "MV X,[SC]
4426 "MV A,200
4427 "ADD X,A
4428 "MV [SC],X
4429 "EMS0S2: ADD (R0),2
4430 "MV (RE0),(RE1)
4431 "DEC (R2)
4432 "JRNZ EMS0S0
4433 "RET
4434 "
4435 "YMOVE: MV (Q0),2
4436 "MV (Q2),0
4437 "MV X,T11
4438 "YM0: MV (Q1),4
4439 "YM1: CALL T1E
4440 "MV A,[BOM]
4441 "DEC A
4442 "JRZ YMS
4443 "MV A,3
4444 "ADD X,A
4445 "DEC (Q1)
4446 "JRNZ YM1
4447 "DEC (Q0)
4448 "JRNZ YM0
4449 "YMS: OR (Q2),0
4450 "JRZ YMR
4451 "CALL GATR
4452 "YMR: RET
4453 "
4454 "AR: MV BA,(G0)
4455 "CALL XHLS
4456 "MV Y,ARD
4457 "MV A,40
4458 "SUB X,A
4459 "MV I,[X++]
4460 "MV [Y++],I
4461 "ADD X,A
4462 "MV IL,[X]
4463 "MV [Y++],IL
4464 "ADD X,A
4465 "MV IL,[X]
4466 "MV [Y++],IL
4467 "SUB X,A
4468 "MV IL,3
4469 "SUB X,IL
4470 "MV IL,[X]
4471 "MV [Y++],IL
4472 "ADD X,A
4473 "MV IL,[X++]
4474 "MV [Y++],IL
4475 "ADD X,A
4476 "MV I,[X]
4477 "MV [Y],I
4478 "MV X,ARD
4479 "MV Y,X
4480 "MV IL,4
4481 "MV (R2),0
4482 "AR0: MVW (R0),[X++]
4483 "MV A,(R1)
4484 "ADD A,(R0)
4485 "JRZ AR1
4486 "CMP A,12
4487 "JRZ AR4
4488 "CMP A,6
4489 "JRZ AR2
4490 "AR3: MV A,1
4491 "INC (R2)
4492 "JR AR1
4493 "AR2: OR (R0),0
4494 "JRZ AR4
4495 "CMP (R0),6
4496 "JRNZ AR3
4497 "AR4: MV A,2
4498 "AR1: MV [Y++],A
4499 "DEC IL
4500 "JRNZ AR0
4501 "RET
4502 "
4503 "T1E1: MV X,ARD
4504 "MV BA,[X++]
4505 "DEC A
4506 "JRZ T1E10
4507 "MVW (R2),0FF00H
4508 "JR T1M
4509 "T1E10: MV A,[X++]
4510 "DEC A
4511 "JRZ T1E11
4512 "MVW (R2),0FFH
4513 "JR T1M
4514 "T1E11: MV A,[X]
4515 "DEC A
4516 "JRZ T1E12
4517 "MVW (R2),100H
4518 "JR T1M
4519 "T1E12: MV A,B
4520 "DEC A
4521 "MVW (R2),1
4522 "T1M: DEC A
4523 "JRNZ T1M0
4524 "INC A
4525 "MV [BOM],A
4526 "MV I,(G0)
4527 "MVW (G0),(G3)
4528 "MV (G2),0
4529 "CALL CPUT
4530 "MV (G0),I
4531 "T1M0: INC (Q2)
4532 "MV A,0
4533 "MV (G2),A
4534 "MV (R0),(G1)
4535 "MV (R1),(G0)
4536 "CALL PUT
4537 "CALL CPUT
4538 "MV BA,(R2)
4539 "ADD (G0),A
4540 "MV A,B
4541 "ADD (G1),A
4542 "MV A,3
4543 "SUB A,(Q0)
4544 "MV (G2),A
4545 "MV (R0),(G1)
4546 "MV (R1),(G0)
4547 "MV X,[U]
4548 "MVW [X],(G0)
4549 "CALL PUT
4550 "CALL CPUT
4551 "JR TECR
4552 "
4553 "T1E1U: MVW (R2),0FF00H
4554 "JR T1M
4555 "
4556 "T1E1D: MVW (R2),100H
4557 "JR T1M
4558 "
4559 "T1E1L: MVW (R2),0FFH
4560 "JR T1M
4561 "
4562 "T1E1R: MVW (R2),1
4563 "JR T1M
4564 "
4565 "TEC: MV (G2),0
4566 "MV I,[--X]
4567 "MV [GAPX],I
4568 "CMP (Q0),2
4569 "JRZ TEC0
4570 "CALL MGET1
4571 "JR TEC1
4572 "TEC0: CALL MGET0
4573 "TEC1: CALL SCPUT
4574 "TECR: POPU X
4575 "RET
4576 "
4577 "T1E: PUSHU X
4578 "MVW (G0),[X++]
4579 "MVW (G3),[MYX]
4580 "MV A,[X]
4581 "OR A,0
4582 "JRZ TECR
4583 "CMP A,2
4584 "JRZ TEC
4585 "CALL AR
4586 "CMP (R2),4
4587 "JRZ TECR
4588 "CMP (R2),3
4589 "JRZ T1E1
4590 "CMP (Q0),2
4591 "JRZ T2E
4592 "CMP (G0),(G3)
4593 "JRNZ T1ES
4594 "CMP (G1),(G4)
4595 "JRC T1E0
4596 "MV A,[ARD]
4597 "DEC A
4598 "JRNZ T1E1U
4599 "JR T1ES
4600 "T1E0: MV A,[ARD+3]
4601 "DEC A
4602 "JRNZ T1E1D
4603 "T1ES: CMP (G1),(G4)
4604 "JRNZ RMOVE
4605 "CMP (G0),(G3)
4606 "T1ES0: JRC T1E2
4607 "MV A,[ARD+2]
4608 "DEC A
4609 "JRNZ T1E1L
4610 "JR RMOVE
4611 "T1E2: MV A,[ARD+1]
4612 "DEC A
4613 "JRNZ T1E1R
4614 "JR RMOVE
4615 "
4616 "RND: MV X,[U]
4617 "MV I,[X]
4618 "MV BA,[RNDD]
4619 "ADD BA,I
4620 "MV (R0),A
4621 "MV A,B
4622 "ADD A,A
4623 "ADD A,(R0)
4624 "MV IL,36H
4625 "ADD BA,IL
4626 "MV [RNDD],BA
4627 "RET
4628 "
4629 "RNDD: DW 1234H
4630 "
4631 "RMOVE: MV (R1),4
4632 "RMOV1: CALL RND
4633 "DEC (R1)
4634 "JPZ T1E1
4635 "CMP A,40H
4636 "JRC RM0
4637 "CMP A,80H
4638 "JRC RM1
4639 "CMP A,0C0H
4640 "JRC RM2
4641 "MV A,[ARD+3]
4642 "DEC A
4643 "JRNZ T1E1D
4644 "JR RMOV1
4645 "RM0: MV A,[ARD]
4646 "DEC A
4647 "JRNZ T1E1U
4648 "JR RMOV1
4649 "RM1: MV A,[ARD+2]
4650 "DEC A
4651 "JRNZ T1E1L
4652 "JR RMOV1
4653 "RM2: MV A,[ARD+1]
4654 "DEC A
4655 "JRNZ T1E1R
4656 "JR RMOV1
4657 "
4658 "T2E: CMP (G0),(G3)
4659 "JRNZ T1ES0
4660 "CMP (G1),(G4)
4661 "JRC T2E1
4662 "MV A,[ARD]
4663 "DEC A
4664 "JRNZ T1E1U
4665 "JR RMOVE
4666 "T2E1: MV A,[ARD+3]
4667 "DEC A
4668 "JPNZ T1E1D
4669 "JR RMOVE
4670 "
4671 "DM '[K.K No17]'
4672 "
4673 "DATA:  DS 2880
4674 "TCONT: DS 1
4675 "GAMN:  DS 880
4676 "SC:    DS 3
4677 "MEN:   DS 1
4678 "CONST: DS 1
4679 "MY:    DS 1
4680 "BOM:   DS 1
4681 "CLR:   DS 2
4682 "MYX:   DS 1
4683 "MYY:   DS 1
4684 "MA:    DS 1
4685 "MA0:   DS 1
4686 "MA1:   DS 1
4687 "MAXY:  DS 2
4688 "T11:   DS 3
4689 "T12:   DS 3
4690 "T13:   DS 3
4691 "T14:   DS 3
4692 "T21:   DS 3
4693 "T22:   DS 3
4694 "T23:   DS 3
4695 "T24:   DS 3
4696 "IWA1:  DS 3
4697 "IWA2:  DS 3
4698 "IWA3:  DS 3
4699 "IWA4:  DS 3
4700 "IWA5:  DS 3
4701 "IWA6:  DS 3
4702 "IWA7:  DS 3
4703 "IWA8:  DS 3
4704 "IWA9:  DS 3
4705 "IWA10: DS 3
4706 "IWA11: DS 3
4707 "IWA12: DS 3
4708 "IWA13: DS 3
4709 "IWA14: DS 3
4710 "IWA15: DS 3
4711 "TIME:  DS 2
4712 "KDATA: DS 1
4713 "SELD0: DS 2
4714 "SELRT: DS 2
4715 "SELSX: DS 3
4716 "SAVEX: DS 3
4717 "LDHED: DS 30H
4718 "DAADT: DS 7
4719 "FILED: DS 10
4720 "VRAM:  DS 448
4721 "GAPX:  DS 1
4722 "GAPY:  DS 1
4723 "CHNO:  DS 1
4724 "MVRAM: DS 126
4725 "MENST: DS 1
4726 "MENSS: DS 1
4727 "MUOCT: DS 1
4728 "BGMD:  DS 3
4729 "EMSMC: DS 1
4730 "ARD:   DS 8
4731 "PJ:    DS 1
